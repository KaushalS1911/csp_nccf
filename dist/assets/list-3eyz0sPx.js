import{cn as ae,c as ne,a as ce,aF as oe,u as X,r as a,dZ as B,K as v,aJ as re,j as e,C as de,cu as ie,p as I,d_ as Re,q as ue,d$ as he,a4 as fe,e0 as me,aA as M,dI as xe,dJ as ge,E as be,cG as je,cH as pe,cI as Ce,cd as we,e1 as Ae,S as _e,D as F,i as ye,dN as Se,dP as ve,e2 as Te,e3 as De,aV as H,d0 as ke,e4 as W,cP as Oe,e5 as Fe,bN as E,e6 as Ne,e7 as Le,e8 as Pe,e9 as Ee,ea as Be,H as Ie}from"./index-FW-_aVVE.js";const K={publish:[],stock:[],commodity:[],status:"all",branch:[],name:"",startDate:null,endDate:null,startDay:null,endDay:null},Me={category:!1},He=["category","actions"];function We({singleCode:l}){const{enqueueSnackbar:f}=ae(),m=ne(),w=ce(),b=oe(),{vendor:r}=X(),[u,c]=a.useState([]),[i,h]=a.useState(K),[x,p]=a.useState([]),[g,j]=a.useState(!1),[n,ee]=a.useState({}),[R,te]=a.useState(!1),[z,G]=a.useState(Me),[$,D]=a.useState([]),[_,U]=a.useState([]),[se,V]=a.useState([]),Y=B(i.startDate,i.endDate),A=B(i.startDay,i.endDay),T=s=>{const d=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${s}/orders`;v.get(d).then(t=>{var o;return c((o=t==null?void 0:t.data)==null?void 0:o.data)}).catch(t=>console.log(t))};a.useEffect(()=>{r&&(v.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080//nccf/branch/${r==null?void 0:r.branch}/csp/list`).then(s=>{var o;const d=((o=s==null?void 0:s.data)==null?void 0:o.data)||[],t=[{name:"All",csp_code:"All"},...d];D(t)}).catch(s=>console.log(s)),v.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${r==null?void 0:r.branch}/order`).then(s=>{var d;return c((d=s==null?void 0:s.data)==null?void 0:d.data)}).catch(s=>console.log(s)))},[]),a.useEffect(()=>{if(_==="All"){const s=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${r==null?void 0:r.branch}/order`;v.get(s).then(d=>{var t;return c((t=d==null?void 0:d.data)==null?void 0:t.data)}).catch(d=>console.log(d))}else T(_)},[_]);const y=ze({inputData:u,filters:i,dateError:Y}),N=a.useCallback(s=>{V(s.target.value),U(s.target.value)},[_]),S=!re(K,i)||!!i.startDate&&!!i.endDate||!!i.startDay&&!!i.endDay,k=a.useCallback((s,d)=>{h(t=>({...t,[s]:d}))},[]),q=a.useCallback(()=>{h(K)},[]);a.useCallback(s=>{const d=u.filter(t=>t.id!==s);f("Delete success!"),c(d)},[f,u]);const O=[{value:"all",label:"All"},{value:"1",label:"Accepted"},{value:"placed",label:"Placed"},{value:"0",label:"Declined"}],Q=a.useCallback(()=>{const s=u.filter(d=>!x.includes(d.id));f("Delete success!"),c(s)},[f,x,u]);a.useCallback(s=>{},[w]);const L=[{field:"id",headerName:"#",minWidth:200,renderCell:s=>e.jsx(Oe,{children:s.row.id})},{field:"commodity",headerName:"Commodity",minWidth:150,flex:1},{field:"quantity",headerName:"Quantity",minWidth:100,flex:1},{field:"created_at",headerName:"Date",minWidth:150,flex:1,renderCell:s=>Fe(s.row.created_at).format("DD/MM/YYYY")},{field:"nccf_order_status",headerName:"Order Status",minWidth:100,flex:1,renderCell:s=>e.jsx(E,{children:e.jsx(M,{variant:"soft",color:s.row.nccf_order_status==="1"&&"success"||s.row.nccf_order_status==="placed"&&"warning"||s.row.nccf_order_status==="0"&&"error"||"default",children:s.row.nccf_order_status==="1"?"Approved":s.row.nccf_order_status==="0"?"Rejected":"Placed"})})}],J=a.useCallback((s,d)=>{k("status",d)},[k]),P=()=>L.filter(s=>!He.includes(s.field)).map(s=>s.field);return e.jsxs(e.Fragment,{children:[e.jsxs(de,{maxWidth:b.themeStretch?!1:"xl",children:[e.jsx(ie,{heading:"Order List",links:[{name:"Dashboard",href:I.dashboard.root},{name:"Order",href:I.dashboard.orders},{name:"List"}],sx:{mb:{xs:3,md:5}}}),e.jsx(Re,{getAllDocument:T,currentUser:n,open:g,setOpen:j,approve:R,cspCode:se}),e.jsxs(ue,{sx:{height:(y==null?void 0:y.length)>0?"unset":700,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[e.jsx(he,{value:i.status,onChange:J,sx:{px:2.5,boxShadow:s=>`inset 0 -2px 0 0 ${fe(s.palette.grey[500],.08)}`},children:O.map(s=>e.jsx(me,{iconPosition:"end",value:s.value,label:s.label,icon:e.jsx(M,{variant:(s.value==="all"||s.value===i.status)&&"filled"||"soft",color:s.value==="1"&&"success"||s.value==="placed"&&"warning"||s.value==="0"&&"error"||"default",children:["1","0","placed"].includes(s.value)?u.filter(d=>d.nccf_order_status===s.value).length:u.length})},s.value))}),e.jsx(xe,{disableRowSelectionOnClick:!0,rows:y,columns:L,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:5}}},columnVisibilityModel:z,onColumnVisibilityModelChange:s=>G(s),slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(ge,{children:[e.jsxs(be,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(je,{children:"CSP"}),e.jsx(pe,{value:_,onChange:N,input:e.jsx(Ce,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:$.map(s=>e.jsx(we,{value:s.csp_code,disabled:s.order_count===0,children:s.name},s.csp_code))})]}),S&&e.jsx(Ae,{filters:i,onFilters:k,onResetFilters:q,results:y.length,sx:{p:2.5,pt:0}}),e.jsxs(_e,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!x.length&&e.jsxs(F,{size:"small",color:"error",startIcon:e.jsx(ye,{icon:"solar:trash-bin-trash-bold"}),onClick:m.onTrue,children:["Delete (",x.length,")"]}),e.jsx(Se,{}),e.jsx(ve,{})]}),e.jsx(Te,{filters:i,onFilters:k,roleOptions:De,branchOptions:["hello"],dateError:Y,dayError:A})]})}),noRowsOverlay:()=>e.jsx(H,{title:"No Data"}),noResultsOverlay:()=>e.jsx(H,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:P}}})]})]}),e.jsx(ke,{open:m.value,onClose:m.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",x.length," "]})," items?"]}),action:e.jsx(F,{variant:"contained",color:"error",onClick:()=>{Q(),m.onFalse()},children:"Delete"})})]})}function ze({inputData:l,filters:f,dateError:m,dayError:w}){const{stock:b,publish:r,status:u,commodity:c,name:i,branch:h,startDate:x,endDate:p,startDay:g,endDay:j}=f;return b.length&&(l=l.filter(n=>b.includes(n.inventoryType))),m||x&&p&&(l=l.filter(n=>W(n.created_at,x,p))),w||g&&j&&(l=l.filter(n=>W(n.created_at,g,j))),r.length&&(l=l.filter(n=>r.includes(n.publish))),i&&(l=l.filter(n=>n.name.toLowerCase().indexOf(i.toLowerCase())!==-1)),u!=="all"&&(l=l.filter(n=>n.nccf_order_status===u)),c.length&&(l=l.filter(n=>c.includes(n.commodity))),h.length&&(l=l.filter(n=>h.includes(n.branch))),l}const Z={publish:[],stock:[],commodity:[],status:"all",branch:[],name:"",startDate:null,endDate:null,startDay:null,endDay:null},Ge={category:!1},$e=["category","actions"];function Ue({singleCode:l}){const{enqueueSnackbar:f}=ae(),m=ne(),w=ce(),b=oe();X();const[r,u]=a.useState([]),[c,i]=a.useState(Z),[h,x]=a.useState([]),[p,g]=a.useState(!1),[j,n]=a.useState({}),[ee,R]=a.useState(!1),[te,z]=a.useState(Ge),[G,$]=a.useState([]),[D,_]=a.useState("All");a.useState([]);const[U,se]=a.useState("All"),[V,Y]=a.useState([]),A=B(c.startDate,c.endDate),T=B(c.startDay,c.endDay),y=()=>{const t=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${D}/order`;v.get(t).then(o=>{var C;return u((C=o==null?void 0:o.data)==null?void 0:C.data)}).catch(o=>console.log(o))};a.useEffect(()=>{D==="All"?N():y()},[D]);const N=()=>{v.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/ho/order").then(t=>{var o;return u((o=t==null?void 0:t.data)==null?void 0:o.data)}).catch(t=>console.log(t))};a.useEffect(()=>{v.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/state/branch").then(t=>{var le;const o=((le=t==null?void 0:t.data)==null?void 0:le.data)||[],C=[{branch_name:"All"},...o];$(C)}).catch(t=>console.log(t))},[]);const S=Ve({inputData:r,filters:c,dateError:A}),k=a.useCallback(t=>{_(t.target.value)},[U]),q=!re(Z,c)||!!c.startDate&&!!c.endDate||!!c.startDay&&!!c.endDay,O=a.useCallback((t,o)=>{i(C=>({...C,[t]:o}))},[]),Q=a.useCallback(()=>{i(Z)},[]);a.useCallback(t=>{const o=r.filter(C=>C.id!==t);f("Delete success!"),u(o)},[f,r]);const L=[{value:"all",label:"All"},{value:"accepted",label:"Accepted"},{value:"placed",label:"Placed"},{value:"declined",label:"Declined"}],J=a.useCallback(()=>{const t=r.filter(o=>!h.includes(o.id));f("Delete success!"),u(t)},[f,h,r]);console.log(r),a.useCallback(t=>{},[w]);const P=[{field:"id",headerName:"#",minWidth:100,renderCell:t=>e.jsx(Oe,{children:t.row.id})},{field:"name",headerName:"Name",width:250},{field:"commodity",headerName:"Commodity",minWidth:150,flex:1},{field:"quantity",headerName:"Quantity",minWidth:100,flex:1},{field:"branch",headerName:"Branch",minWidth:100,flex:1},{field:"created_at",headerName:"Date",minWidth:150,flex:1,renderCell:t=>Fe(t.row.created_at).format("DD/MM/YYYY")},{field:"nccf_order_status",headerName:"Order Status",minWidth:100,flex:1,renderCell:t=>e.jsx(E,{children:e.jsx(M,{variant:"soft",color:t.row.nccf_order_status==="accepted"&&"success"||t.row.nccf_order_status==="placed"&&"warning"||t.row.nccf_order_status==="declined"&&"error"||"default",children:t.row.nccf_order_status==="accepted"?"Accepted":t.row.nccf_order_status==="declined"?"Declined":"Placed"})})},{field:"vendor1",headerName:"Action",flex:.5,minWidth:250,renderCell:t=>e.jsxs(e.Fragment,{children:[e.jsx(E,{sx:{px:0,marginRight:2},children:e.jsxs(F,{disabled:t.row.nccf_order_status==="accepted"||t.row.nccf_order_status==="declined",variant:"contained",onClick:()=>{n(t.row),R(!0),g(!0)},sx:{backgroundColor:"green",width:90},children:[e.jsx(Ee,{})," Approve"]})}),e.jsx(E,{sx:{px:0},children:e.jsxs(F,{disabled:t.row.nccf_order_status==="accepted"||t.row.nccf_order_status==="declined",onClick:()=>{n(t.row),R(!1),g(!0)},variant:"contained",sx:{backgroundColor:"red",width:80},children:[e.jsx(Be,{})," Reject"]})})]})}],s=a.useCallback((t,o)=>{O("status",o)},[O]),d=()=>P.filter(t=>!$e.includes(t.field)).map(t=>t.field);return e.jsxs(e.Fragment,{children:[e.jsxs(de,{maxWidth:b.themeStretch?!1:"xl",children:[e.jsx(ie,{heading:"Order List",links:[{name:"Dashboard",href:I.dashboard.root},{name:"Order",href:I.dashboard.orders},{name:"List"}],sx:{mb:{xs:3,md:5}}}),e.jsx(Ne,{getAllDocument:N,currentUser:j,open:p,setOpen:g,approve:ee,cspCode:V}),e.jsxs(ue,{sx:{height:(S==null?void 0:S.length)>0?"unset":700,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[e.jsx(he,{value:c.status,onChange:s,sx:{px:2.5,boxShadow:t=>`inset 0 -2px 0 0 ${fe(t.palette.grey[500],.08)}`},children:L.map(t=>e.jsx(me,{iconPosition:"end",value:t.value,label:t.label,icon:e.jsx(M,{variant:(t.value==="all"||t.value===c.status)&&"filled"||"soft",color:t.value==="accepted"&&"success"||t.value==="placed"&&"warning"||t.value==="declined"&&"error"||"default",children:["accepted","declined","placed"].includes(t.value)?r.filter(o=>o.nccf_order_status===t.value).length:r.length})},t.value))}),e.jsx(xe,{disableRowSelectionOnClick:!0,rows:S,columns:P,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:5}}},columnVisibilityModel:te,onColumnVisibilityModelChange:t=>z(t),slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(ge,{children:[e.jsxs(be,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(je,{children:"Branch"}),e.jsx(pe,{value:D,onChange:k,input:e.jsx(Ce,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:G.map(t=>e.jsx(we,{value:t.branch_name,children:t.branch_name},t.branch_name))})]}),q&&e.jsx(Le,{filters:c,onFilters:O,onResetFilters:Q,results:S.length,sx:{p:2.5,pt:0}}),e.jsxs(_e,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!h.length&&e.jsxs(F,{size:"small",color:"error",startIcon:e.jsx(ye,{icon:"solar:trash-bin-trash-bold"}),onClick:m.onTrue,children:["Delete (",h.length,")"]}),e.jsx(Se,{}),e.jsx(ve,{})]}),e.jsx(Pe,{filters:c,onFilters:O,roleOptions:De,branchOptions:["hello"],dateError:A,dayError:T})]})}),noRowsOverlay:()=>e.jsx(H,{title:"No Data"}),noResultsOverlay:()=>e.jsx(H,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:d}}})]})]}),e.jsx(ke,{open:m.value,onClose:m.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",h.length," "]})," items?"]}),action:e.jsx(F,{variant:"contained",color:"error",onClick:()=>{J(),m.onFalse()},children:"Delete"})})]})}function Ve({inputData:l,filters:f,dateError:m,dayError:w}){const{stock:b,publish:r,status:u,commodity:c,name:i,branch:h,startDate:x,endDate:p,startDay:g,endDay:j}=f;return b.length&&(l=l.filter(n=>b.includes(n.inventoryType))),m||x&&p&&(l=l.filter(n=>W(n.created_at,x,p))),w||g&&j&&(l=l.filter(n=>W(n.created_at,g,j))),r.length&&(l=l.filter(n=>r.includes(n.publish))),i&&(l=l.filter(n=>n.name.toLowerCase().indexOf(i.toLowerCase())!==-1)),u!=="all"&&(l=l.filter(n=>n.nccf_order_status===u)),c.length&&(l=l.filter(n=>c.includes(n.commodity))),h.length&&(l=l.filter(n=>h.includes(n.branch))),l}function qe(){const{vendor:l}=X();return e.jsxs(e.Fragment,{children:[e.jsx(Ie,{children:e.jsx("title",{children:" Dashboard: Order List"})}),(l==null?void 0:l.category)==="branch"?e.jsx(We,{}):e.jsx(Ue,{})]})}export{qe as default};
