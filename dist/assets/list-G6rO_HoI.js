import{cn as ae,c as ne,a as oe,aF as ce,u as X,r as a,dZ as B,K as v,aJ as re,j as e,C as ie,cu as de,p as I,d_ as Re,q as ue,d$ as he,a4 as fe,e0 as xe,aA as M,dI as me,dJ as ge,E as be,cG as je,cH as Ce,cI as pe,cd as we,e1 as Ae,S as _e,D as F,i as ye,dN as Se,dP as ve,e2 as Te,e3 as De,aV as H,d0 as ke,e4 as W,cP as Oe,e5 as Fe,bN as E,e6 as Le,e7 as Pe,e8 as Ne,e9 as Ee,ea as Be,H as Ie}from"./index-KjhAZpdY.js";const K={publish:[],stock:[],commodity:[],status:"all",branch:[],name:"",startDate:null,endDate:null,startDay:null,endDay:null},Me={category:!1},He=["category","actions"];function We({singleCode:l}){const{enqueueSnackbar:f}=ae(),x=ne(),w=oe(),b=ce(),{vendor:r}=X(),[u,o]=a.useState([]),[d,h]=a.useState(K),[m,C]=a.useState([]),[g,j]=a.useState(!1),[n,ee]=a.useState({}),[R,te]=a.useState(!1),[z,G]=a.useState(Me),[$,D]=a.useState([]),[_,U]=a.useState([]),[se,V]=a.useState([]),Y=B(d.startDate,d.endDate),A=B(d.startDay,d.endDay),T=s=>{const i=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${s}/orders`;v.get(i).then(t=>{var c;return o((c=t==null?void 0:t.data)==null?void 0:c.data)}).catch(t=>console.log(t))};a.useEffect(()=>{r&&(v.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080//nccf/branch/${r==null?void 0:r.branch}/csp/list`).then(s=>{var c;const i=((c=s==null?void 0:s.data)==null?void 0:c.data)||[],t=[{name:"All",csp_code:"All"},...i];D(t)}).catch(s=>console.log(s)),v.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${r==null?void 0:r.branch}/order`).then(s=>{var i;return o((i=s==null?void 0:s.data)==null?void 0:i.data)}).catch(s=>console.log(s)))},[]),a.useEffect(()=>{if(_==="All"){const s=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${r==null?void 0:r.branch}/order`;v.get(s).then(i=>{var t;return o((t=i==null?void 0:i.data)==null?void 0:t.data)}).catch(i=>console.log(i))}else T(_)},[_]);const y=ze({inputData:u,filters:d,dateError:Y}),L=a.useCallback(s=>{V(s.target.value),U(s.target.value)},[_]),S=!re(K,d)||!!d.startDate&&!!d.endDate||!!d.startDay&&!!d.endDay,k=a.useCallback((s,i)=>{h(t=>({...t,[s]:i}))},[]),q=a.useCallback(()=>{h(K)},[]);a.useCallback(s=>{const i=u.filter(t=>t.id!==s);f("Delete success!"),o(i)},[f,u]);const O=[{value:"all",label:"All"},{value:"1",label:"Accepted"},{value:"placed",label:"Placed"},{value:"0",label:"Declined"}],Q=a.useCallback(()=>{const s=u.filter(i=>!m.includes(i.id));f("Delete success!"),o(s)},[f,m,u]);a.useCallback(s=>{},[w]);const P=[{field:"id",headerName:"#",minWidth:200,renderCell:s=>e.jsx(Oe,{children:s.row.id})},{field:"commodity",headerName:"Commodity",minWidth:150,flex:1},{field:"quantity",headerName:"Quantity",minWidth:100,flex:1},{field:"created_at",headerName:"Date",minWidth:150,flex:1,renderCell:s=>Fe(s.row.created_at).format("DD/MM/YYYY")},{field:"nccf_order_status",headerName:"Order Status",minWidth:100,flex:1,renderCell:s=>e.jsx(E,{children:e.jsx(M,{variant:"soft",color:s.row.nccf_order_status==="1"&&"success"||s.row.nccf_order_status==="placed"&&"warning"||s.row.nccf_order_status==="0"&&"error"||"default",children:s.row.nccf_order_status==="1"?"Approved":s.row.nccf_order_status==="0"?"Rejected":"Placed"})})}],J=a.useCallback((s,i)=>{k("status",i)},[k]),N=()=>P.filter(s=>!He.includes(s.field)).map(s=>s.field);return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{maxWidth:b.themeStretch?!1:"xl",children:[e.jsx(de,{heading:"Order List",links:[{name:"Dashboard",href:I.dashboard.root},{name:"Order",href:I.dashboard.orders},{name:"List"}],sx:{mb:{xs:3,md:5}}}),e.jsx(Re,{getAllDocument:T,currentUser:n,open:g,setOpen:j,approve:R,cspCode:se}),e.jsxs(ue,{sx:{height:(y==null?void 0:y.length)>0?"unset":700,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[e.jsx(he,{value:d.status,onChange:J,sx:{px:2.5,boxShadow:s=>`inset 0 -2px 0 0 ${fe(s.palette.grey[500],.08)}`},children:O.map(s=>e.jsx(xe,{iconPosition:"end",value:s.value,label:s.label,icon:e.jsx(M,{variant:(s.value==="all"||s.value===d.status)&&"filled"||"soft",color:s.value==="1"&&"success"||s.value==="placed"&&"warning"||s.value==="0"&&"error"||"default",children:["1","0","placed"].includes(s.value)?u.filter(i=>i.nccf_order_status===s.value).length:u.length})},s.value))}),e.jsx(me,{disableRowSelectionOnClick:!0,rows:y,columns:P,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:5}}},columnVisibilityModel:z,onColumnVisibilityModelChange:s=>G(s),slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(ge,{children:[e.jsxs(be,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(je,{children:"CSP"}),e.jsx(Ce,{value:_,onChange:L,input:e.jsx(pe,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:$.map(s=>e.jsx(we,{value:s.csp_code,disabled:s.order_count===0,children:s.name},s.csp_code))})]}),S&&e.jsx(Ae,{filters:d,onFilters:k,onResetFilters:q,results:y.length,sx:{p:2.5,pt:0}}),e.jsxs(_e,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!m.length&&e.jsxs(F,{size:"small",color:"error",startIcon:e.jsx(ye,{icon:"solar:trash-bin-trash-bold"}),onClick:x.onTrue,children:["Delete (",m.length,")"]}),e.jsx(Se,{}),e.jsx(ve,{})]}),e.jsx(Te,{filters:d,onFilters:k,roleOptions:De,branchOptions:["hello"],dateError:Y,dayError:A})]})}),noRowsOverlay:()=>e.jsx(H,{title:"No Data"}),noResultsOverlay:()=>e.jsx(H,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:N}}})]})]}),e.jsx(ke,{open:x.value,onClose:x.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",m.length," "]})," items?"]}),action:e.jsx(F,{variant:"contained",color:"error",onClick:()=>{Q(),x.onFalse()},children:"Delete"})})]})}function ze({inputData:l,filters:f,dateError:x,dayError:w}){const{stock:b,publish:r,status:u,commodity:o,name:d,branch:h,startDate:m,endDate:C,startDay:g,endDay:j}=f;return b.length&&(l=l.filter(n=>b.includes(n.inventoryType))),x||m&&C&&(l=l.filter(n=>W(n.created_at,m,C))),w||g&&j&&(l=l.filter(n=>W(n.created_at,g,j))),r.length&&(l=l.filter(n=>r.includes(n.publish))),d&&(l=l.filter(n=>n.name.toLowerCase().indexOf(d.toLowerCase())!==-1)),u!=="all"&&(l=l.filter(n=>n.nccf_order_status===u)),o.length&&(l=l.filter(n=>o.includes(n.commodity))),h.length&&(l=l.filter(n=>h.includes(n.branch))),l}const Z={publish:[],stock:[],commodity:[],status:"all",branch:[],name:"",startDate:null,endDate:null,startDay:null,endDay:null},Ge={category:!1},$e=["category","actions"];function Ue({singleCode:l}){const{enqueueSnackbar:f}=ae(),x=ne(),w=oe(),b=ce();X();const[r,u]=a.useState([]),[o,d]=a.useState(Z),[h,m]=a.useState([]),[C,g]=a.useState(!1),[j,n]=a.useState({}),[ee,R]=a.useState(!1),[te,z]=a.useState(Ge),[G,$]=a.useState([]),[D,_]=a.useState("All");a.useState([]);const[U,se]=a.useState("All"),[V,Y]=a.useState([]),A=B(o.startDate,o.endDate),T=B(o.startDay,o.endDay),y=()=>{const t=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${D}/order`;v.get(t).then(c=>{var p;return u((p=c==null?void 0:c.data)==null?void 0:p.data)}).catch(c=>console.log(c))};a.useEffect(()=>{D==="All"?L():y()},[D]);const L=()=>{v.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/ho/order").then(t=>{var c;return u((c=t==null?void 0:t.data)==null?void 0:c.data)}).catch(t=>console.log(t))};a.useEffect(()=>{v.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/state/branch").then(t=>{var le;const c=((le=t==null?void 0:t.data)==null?void 0:le.data)||[],p=[{branch_name:"All"},...c];$(p)}).catch(t=>console.log(t))},[]);const S=Ve({inputData:r,filters:o,dateError:A}),k=a.useCallback(t=>{_(t.target.value)},[U]),q=!re(Z,o)||!!o.startDate&&!!o.endDate||!!o.startDay&&!!o.endDay,O=a.useCallback((t,c)=>{d(p=>({...p,[t]:c}))},[]),Q=a.useCallback(()=>{d(Z)},[]);a.useCallback(t=>{const c=r.filter(p=>p.id!==t);f("Delete success!"),u(c)},[f,r]);const P=[{value:"all",label:"All"},{value:"1",label:"Accepted"},{value:"placed",label:"Placed"},{value:"0",label:"Declined"}],J=a.useCallback(()=>{const t=r.filter(c=>!h.includes(c.id));f("Delete success!"),u(t)},[f,h,r]);console.log(r),a.useCallback(t=>{},[w]);const N=[{field:"id",headerName:"#",minWidth:100,renderCell:t=>e.jsx(Oe,{children:t.row.id})},{field:"commodity",headerName:"Commodity",minWidth:150,flex:1},{field:"quantity",headerName:"Quantity",minWidth:100,flex:1},{field:"branch",headerName:"Branch",minWidth:100,flex:1},{field:"created_at",headerName:"Date",minWidth:150,flex:1,renderCell:t=>Fe(t.row.created_at).format("DD/MM/YYYY")},{field:"nccf_order_status",headerName:"Order Status",minWidth:100,flex:1,renderCell:t=>e.jsx(E,{children:e.jsx(M,{variant:"soft",color:t.row.nccf_order_status==="1"&&"success"||t.row.nccf_order_status==="placed"&&"warning"||t.row.nccf_order_status==="0"&&"error"||"default",children:t.row.nccf_order_status==="1"?"Accepted":t.row.nccf_order_status==="0"?"Declined":"Placed"})})},{field:"vendor1",headerName:"Action",flex:.5,minWidth:250,renderCell:t=>e.jsxs(e.Fragment,{children:[e.jsx(E,{sx:{px:0,marginRight:2},children:e.jsxs(F,{disabled:t.row.nccf_order_status==="1"||t.row.nccf_order_status==="0",variant:"contained",onClick:()=>{n(t.row),R(!0),g(!0)},sx:{backgroundColor:"green",width:90},children:[e.jsx(Ee,{})," Approve"]})}),e.jsx(E,{sx:{px:0},children:e.jsxs(F,{disabled:t.row.nccf_order_status==="1"||t.row.nccf_order_status==="0",onClick:()=>{n(t.row),R(!1),g(!0)},variant:"contained",sx:{backgroundColor:"red",width:80},children:[e.jsx(Be,{})," Reject"]})})]})}],s=a.useCallback((t,c)=>{O("status",c)},[O]),i=()=>N.filter(t=>!$e.includes(t.field)).map(t=>t.field);return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{maxWidth:b.themeStretch?!1:"xl",children:[e.jsx(de,{heading:"Order List",links:[{name:"Dashboard",href:I.dashboard.root},{name:"Order",href:I.dashboard.orders},{name:"List"}],sx:{mb:{xs:3,md:5}}}),e.jsx(Le,{getAllDocument:L,currentUser:j,open:C,setOpen:g,approve:ee,cspCode:V}),e.jsxs(ue,{sx:{height:(S==null?void 0:S.length)>0?"unset":700,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[e.jsx(he,{value:o.status,onChange:s,sx:{px:2.5,boxShadow:t=>`inset 0 -2px 0 0 ${fe(t.palette.grey[500],.08)}`},children:P.map(t=>e.jsx(xe,{iconPosition:"end",value:t.value,label:t.label,icon:e.jsx(M,{variant:(t.value==="all"||t.value===o.status)&&"filled"||"soft",color:t.value==="1"&&"success"||t.value==="placed"&&"warning"||t.value==="0"&&"error"||"default",children:["1","0",""].includes(t.value)?r.filter(c=>c.nccf_order_status===t.value).length:r.length})},t.value))}),e.jsx(me,{disableRowSelectionOnClick:!0,rows:S,columns:N,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:5}}},columnVisibilityModel:te,onColumnVisibilityModelChange:t=>z(t),slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(ge,{children:[e.jsxs(be,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(je,{children:"Branch"}),e.jsx(Ce,{value:D,onChange:k,input:e.jsx(pe,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:G.map(t=>e.jsx(we,{value:t.branch_name,children:t.branch_name},t.branch_name))})]}),q&&e.jsx(Pe,{filters:o,onFilters:O,onResetFilters:Q,results:S.length,sx:{p:2.5,pt:0}}),e.jsxs(_e,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!h.length&&e.jsxs(F,{size:"small",color:"error",startIcon:e.jsx(ye,{icon:"solar:trash-bin-trash-bold"}),onClick:x.onTrue,children:["Delete (",h.length,")"]}),e.jsx(Se,{}),e.jsx(ve,{})]}),e.jsx(Ne,{filters:o,onFilters:O,roleOptions:De,branchOptions:["hello"],dateError:A,dayError:T})]})}),noRowsOverlay:()=>e.jsx(H,{title:"No Data"}),noResultsOverlay:()=>e.jsx(H,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:i}}})]})]}),e.jsx(ke,{open:x.value,onClose:x.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",h.length," "]})," items?"]}),action:e.jsx(F,{variant:"contained",color:"error",onClick:()=>{J(),x.onFalse()},children:"Delete"})})]})}function Ve({inputData:l,filters:f,dateError:x,dayError:w}){const{stock:b,publish:r,status:u,commodity:o,name:d,branch:h,startDate:m,endDate:C,startDay:g,endDay:j}=f;return b.length&&(l=l.filter(n=>b.includes(n.inventoryType))),x||m&&C&&(l=l.filter(n=>W(n.created_at,m,C))),w||g&&j&&(l=l.filter(n=>W(n.created_at,g,j))),r.length&&(l=l.filter(n=>r.includes(n.publish))),d&&(l=l.filter(n=>n.name.toLowerCase().indexOf(d.toLowerCase())!==-1)),u!=="all"&&(l=l.filter(n=>n.nccf_order_status===u)),o.length&&(l=l.filter(n=>o.includes(n.commodity))),h.length&&(l=l.filter(n=>h.includes(n.branch))),l}function qe(){const{vendor:l}=X();return e.jsxs(e.Fragment,{children:[e.jsx(Ie,{children:e.jsx("title",{children:" Dashboard: Order List"})}),(l==null?void 0:l.category)==="branch"?e.jsx(We,{}):e.jsx(Ue,{})]})}export{qe as default};
