import{cn as ue,c as he,a as fe,aF as xe,u as ce,r as l,dY as M,K as y,aJ as me,j as e,C as ge,cu as be,p as B,dZ as Ae,q as je,d_ as Ce,a4 as pe,d$ as we,aA as I,dH as _e,dI as Se,E as se,cG as ae,cH as le,cI as ne,cd as oe,e0 as Le,S as ye,D as P,i as ve,dM as De,dO as ke,e1 as Ne,e2 as Oe,aV as H,d0 as Fe,e3 as z,cP as Re,e4 as Pe,bN as E,e5 as Ee,e6 as Me,e7 as Be,e8 as Ie,e9 as He,H as ze}from"./index-oVXCsjp_.js";const ee={publish:[],stock:[],commodity:[],status:"all",branch:[],name:"",startDate:null,endDate:null,startDay:null,endDay:null},We={category:!1},Ge=["category","actions"];function $e({singleCode:a}){const{enqueueSnackbar:x}=ue(),m=he(),v=fe(),j=xe(),{vendor:i}=ce(),[u,o]=l.useState([]),[r,f]=l.useState(ee),[g,p]=l.useState([]),[b,C]=l.useState(!1),[n,re]=l.useState({}),[T,de]=l.useState(!1),[W,G]=l.useState(We),[$,U]=l.useState([]),[D,V]=l.useState([]),[Y,w]=l.useState([]),A=M(r.startDate,r.endDate),q=M(r.startDay,r.endDay),L=s=>{const c=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${s}/orders`;y.get(c).then(h=>{var R;return o((R=h==null?void 0:h.data)==null?void 0:R.data)}).catch(h=>console.log(h))};l.useEffect(()=>{i&&(y.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080//nccf/branch/${i==null?void 0:i.branch}/csp/list`).then(s=>{var R;const c=((R=s==null?void 0:s.data)==null?void 0:R.data)||[],h=[{name:"All",csp_code:"All"},...c];U(h)}).catch(s=>console.log(s)),y.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/noida/order").then(s=>{var c;return o((c=s==null?void 0:s.data)==null?void 0:c.data)}).catch(s=>console.log(s)))},[]),l.useEffect(()=>{if(D==="All"){const s=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${i==null?void 0:i.branch}/order`;y.get(s).then(c=>{var h;return o((h=c==null?void 0:c.data)==null?void 0:h.data)}).catch(c=>console.log(c))}else L(D)},[D]);const _=Ue({inputData:u,filters:r,dateError:A}),Q=l.useCallback(s=>{w(s.target.value),V(s.target.value)},[D]),J=!me(ee,r)||!!r.startDate&&!!r.endDate||!!r.startDay&&!!r.endDay,k=l.useCallback((s,c)=>{f(h=>({...h,[s]:c}))},[]),O=l.useCallback(()=>{f(ee)},[]);l.useCallback(s=>{const c=u.filter(h=>h.id!==s);x("Delete success!"),o(c)},[x,u]);const K=[{value:"all",label:"All"},{value:"1",label:"Accepted"},{value:"placed",label:"Placed"},{value:"0",label:"Declined"}],Z=l.useCallback(()=>{const s=u.filter(c=>!g.includes(c.id));x("Delete success!"),o(s)},[x,g,u]);l.useCallback(s=>{},[v]);const N=[{field:"id",headerName:"#",minWidth:200,renderCell:s=>e.jsx(Re,{children:s.row.id})},{field:"commodity",headerName:"Commodity",minWidth:150,flex:1},{field:"quantity",headerName:"Quantity",minWidth:100,flex:1},{field:"created_at",headerName:"Date",minWidth:150,flex:1,renderCell:s=>Pe(s.row.created_at).format("DD/MM/YYYY")},{field:"nccf_order_status",headerName:"Order Status",minWidth:100,flex:1,renderCell:s=>e.jsx(E,{children:e.jsx(I,{variant:"soft",color:s.row.nccf_order_status==="1"&&"success"||s.row.nccf_order_status==="placed"&&"warning"||s.row.nccf_order_status==="0"&&"error"||"default",children:s.row.nccf_order_status==="1"?"Approved":s.row.nccf_order_status==="0"?"Rejected":"Placed"})})}],F=l.useCallback((s,c)=>{k("status",c)},[k]),X=()=>N.filter(s=>!Ge.includes(s.field)).map(s=>s.field);return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{maxWidth:j.themeStretch?!1:"xl",children:[e.jsx(be,{heading:"Order List",links:[{name:"Dashboard",href:B.dashboard.root},{name:"Order",href:B.dashboard.orders},{name:"List"}],sx:{mb:{xs:3,md:5}}}),e.jsx(Ae,{getAllDocument:L,currentUser:n,open:b,setOpen:C,approve:T,cspCode:Y}),e.jsxs(je,{sx:{height:(_==null?void 0:_.length)>0?"unset":700,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[e.jsx(Ce,{value:r.status,onChange:F,sx:{px:2.5,boxShadow:s=>`inset 0 -2px 0 0 ${pe(s.palette.grey[500],.08)}`},children:K.map(s=>e.jsx(we,{iconPosition:"end",value:s.value,label:s.label,icon:e.jsx(I,{variant:(s.value==="all"||s.value===r.status)&&"filled"||"soft",color:s.value==="1"&&"success"||s.value==="placed"&&"warning"||s.value==="0"&&"error"||"default",children:["1","0","placed"].includes(s.value)?u.filter(c=>c.nccf_order_status===s.value).length:u.length})},s.value))}),e.jsx(_e,{disableRowSelectionOnClick:!0,rows:_,columns:N,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:5}}},columnVisibilityModel:W,onColumnVisibilityModelChange:s=>G(s),slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(Se,{children:[e.jsxs(se,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(ae,{children:"CSP"}),e.jsx(le,{value:D,onChange:Q,input:e.jsx(ne,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:$.map(s=>e.jsx(oe,{value:s.csp_code,disabled:s.order_count===0,children:s.name},s.csp_code))})]}),J&&e.jsx(Le,{filters:r,onFilters:k,onResetFilters:O,results:_.length,sx:{p:2.5,pt:0}}),e.jsxs(ye,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!g.length&&e.jsxs(P,{size:"small",color:"error",startIcon:e.jsx(ve,{icon:"solar:trash-bin-trash-bold"}),onClick:m.onTrue,children:["Delete (",g.length,")"]}),e.jsx(De,{}),e.jsx(ke,{})]}),e.jsx(Ne,{filters:r,onFilters:k,roleOptions:Oe,branchOptions:["hello"],dateError:A,dayError:q})]})}),noRowsOverlay:()=>e.jsx(H,{title:"No Data"}),noResultsOverlay:()=>e.jsx(H,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:X}}})]})]}),e.jsx(Fe,{open:m.value,onClose:m.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",g.length," "]})," items?"]}),action:e.jsx(P,{variant:"contained",color:"error",onClick:()=>{Z(),m.onFalse()},children:"Delete"})})]})}function Ue({inputData:a,filters:x,dateError:m,dayError:v}){const{stock:j,publish:i,status:u,commodity:o,name:r,branch:f,startDate:g,endDate:p,startDay:b,endDay:C}=x;return j.length&&(a=a.filter(n=>j.includes(n.inventoryType))),m||g&&p&&(a=a.filter(n=>z(n.created_at,g,p))),v||b&&C&&(a=a.filter(n=>z(n.created_at,b,C))),i.length&&(a=a.filter(n=>i.includes(n.publish))),r&&(a=a.filter(n=>n.name.toLowerCase().indexOf(r.toLowerCase())!==-1)),u!=="all"&&(a=a.filter(n=>n.nccf_order_status===u)),o.length&&(a=a.filter(n=>o.includes(n.commodity))),f.length&&(a=a.filter(n=>f.includes(n.branch))),a}const te={publish:[],stock:[],commodity:[],status:"all",branch:[],name:"",startDate:null,endDate:null,startDay:null,endDay:null},Ve={category:!1},Ye=["category","actions"];function qe({singleCode:a}){const{enqueueSnackbar:x}=ue(),m=he(),v=fe(),j=xe();ce();const[i,u]=l.useState([]),[o,r]=l.useState(te),[f,g]=l.useState([]),[p,b]=l.useState(!1),[C,n]=l.useState({}),[re,T]=l.useState(!1),[de,W]=l.useState(Ve),[G,$]=l.useState([]),[U,D]=l.useState(""),[V,Y]=l.useState([]),[w,A]=l.useState("All"),[q,L]=l.useState([]),_=M(o.startDate,o.endDate),Q=M(o.startDay,o.endDay),J=()=>{const t=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${w}/orders`;y.get(t).then(d=>{var S;return u((S=d==null?void 0:d.data)==null?void 0:S.data)}).catch(d=>console.log(d))};l.useEffect(()=>{w==="All"?k():J()},[w]);const k=()=>{y.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/ho/order").then(t=>{var d;return u((d=t==null?void 0:t.data)==null?void 0:d.data)}).catch(t=>console.log(t))};l.useEffect(()=>{y.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/state/branch").then(t=>{var d;return $((d=t==null?void 0:t.data)==null?void 0:d.data)}).catch(t=>console.log(t)),y.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/ho/csp/list").then(t=>{var ie;const d=((ie=t==null?void 0:t.data)==null?void 0:ie.data)||[],S=[{name:"All",csp_code:"All"},...d];Y(S)}).catch(t=>console.log(t))},[]);const O=Qe({inputData:i,filters:o,dateError:_}),K=l.useCallback(t=>{L(t.target.value),A(t.target.value)},[w]),Z=l.useCallback(t=>{D(t.target.value),F("branch",t.target.value)},[w]),N=!me(te,o)||!!o.startDate&&!!o.endDate||!!o.startDay&&!!o.endDay,F=l.useCallback((t,d)=>{r(S=>({...S,[t]:d}))},[]),X=l.useCallback(()=>{r(te)},[]);l.useCallback(t=>{const d=i.filter(S=>S.id!==t);x("Delete success!"),u(d)},[x,i]);const s=[{value:"all",label:"All"},{value:"1",label:"Accepted"},{value:"",label:"Placed"},{value:"0",label:"Declined"}],c=l.useCallback(()=>{const t=i.filter(d=>!f.includes(d.id));x("Delete success!"),u(t)},[x,f,i]);l.useCallback(t=>{},[v]);const h=[{field:"id",headerName:"#",minWidth:100,renderCell:t=>e.jsx(Re,{children:t.row.id})},{field:"commodity",headerName:"Commodity",minWidth:150,flex:1},{field:"quantity",headerName:"Quantity",minWidth:100,flex:1},{field:"branch",headerName:"Branch",minWidth:100,flex:1},{field:"created_at",headerName:"Date",minWidth:150,flex:1,renderCell:t=>Pe(t.row.created_at).format("DD/MM/YYYY")},{field:"nccf_order_status",headerName:"Order Status",minWidth:100,flex:1,renderCell:t=>e.jsx(E,{children:e.jsx(I,{variant:"soft",color:t.row.nccf_order_status==="1"&&"success"||t.row.nccf_order_status===""&&"warning"||t.row.nccf_order_status==="0"&&"error"||"default",children:t.row.nccf_order_status==="1"?"Accepted":t.row.nccf_order_status==="0"?"Declined":"Placed"})})},{field:"vendor1",headerName:"Action",flex:.5,minWidth:250,renderCell:t=>e.jsxs(e.Fragment,{children:[e.jsx(E,{sx:{px:0,marginRight:2},children:e.jsxs(P,{disabled:t.row.nccf_order_status==="1"||t.row.nccf_order_status==="0",variant:"contained",onClick:()=>{n(t.row),T(!0),b(!0)},sx:{backgroundColor:"green",width:90},children:[e.jsx(Ie,{})," Approve"]})}),e.jsx(E,{sx:{px:0},children:e.jsxs(P,{disabled:t.row.nccf_order_status==="1"||t.row.nccf_order_status==="0",onClick:()=>{n(t.row),T(!1),b(!0)},variant:"contained",sx:{backgroundColor:"red",width:80},children:[e.jsx(He,{})," Reject"]})})]})}],R=l.useCallback((t,d)=>{F("status",d)},[F]),Te=()=>h.filter(t=>!Ye.includes(t.field)).map(t=>t.field);return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{maxWidth:j.themeStretch?!1:"xl",children:[e.jsx(be,{heading:"Order List",links:[{name:"Dashboard",href:B.dashboard.root},{name:"Order",href:B.dashboard.orders},{name:"List"}],sx:{mb:{xs:3,md:5}}}),e.jsx(Ee,{getAllDocument:k,currentUser:C,open:p,setOpen:b,approve:re,cspCode:q}),e.jsxs(je,{sx:{height:(O==null?void 0:O.length)>0?"unset":700,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[e.jsx(Ce,{value:o.status,onChange:R,sx:{px:2.5,boxShadow:t=>`inset 0 -2px 0 0 ${pe(t.palette.grey[500],.08)}`},children:s.map(t=>e.jsx(we,{iconPosition:"end",value:t.value,label:t.label,icon:e.jsx(I,{variant:(t.value==="all"||t.value===o.status)&&"filled"||"soft",color:t.value==="1"&&"success"||t.value===""&&"warning"||t.value==="0"&&"error"||"default",children:["1","0",""].includes(t.value)?i.filter(d=>d.nccf_order_status===t.value).length:i.length})},t.value))}),e.jsx(_e,{disableRowSelectionOnClick:!0,rows:O,columns:h,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:5}}},columnVisibilityModel:de,onColumnVisibilityModelChange:t=>W(t),slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(Se,{children:[e.jsxs(se,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(ae,{children:"Branch"}),e.jsx(le,{value:U,onChange:Z,input:e.jsx(ne,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:G.map(t=>e.jsx(oe,{value:t.branch_name,children:t.branch_name},t.branch_name))})]}),e.jsxs(se,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(ae,{children:"CSP"}),e.jsx(le,{value:w,onChange:K,input:e.jsx(ne,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:V.map(t=>e.jsx(oe,{value:t.csp_code,disabled:t.order_count===0,children:t.name},t.csp_code))})]}),N&&e.jsx(Me,{filters:o,onFilters:F,onResetFilters:X,results:O.length,sx:{p:2.5,pt:0}}),e.jsxs(ye,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!f.length&&e.jsxs(P,{size:"small",color:"error",startIcon:e.jsx(ve,{icon:"solar:trash-bin-trash-bold"}),onClick:m.onTrue,children:["Delete (",f.length,")"]}),e.jsx(De,{}),e.jsx(ke,{})]}),e.jsx(Be,{filters:o,onFilters:F,roleOptions:Oe,branchOptions:["hello"],dateError:_,dayError:Q})]})}),noRowsOverlay:()=>e.jsx(H,{title:"No Data"}),noResultsOverlay:()=>e.jsx(H,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:Te}}})]})]}),e.jsx(Fe,{open:m.value,onClose:m.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",f.length," "]})," items?"]}),action:e.jsx(P,{variant:"contained",color:"error",onClick:()=>{c(),m.onFalse()},children:"Delete"})})]})}function Qe({inputData:a,filters:x,dateError:m,dayError:v}){const{stock:j,publish:i,status:u,commodity:o,name:r,branch:f,startDate:g,endDate:p,startDay:b,endDay:C}=x;return j.length&&(a=a.filter(n=>j.includes(n.inventoryType))),m||g&&p&&(a=a.filter(n=>z(n.created_at,g,p))),v||b&&C&&(a=a.filter(n=>z(n.created_at,b,C))),i.length&&(a=a.filter(n=>i.includes(n.publish))),r&&(a=a.filter(n=>n.name.toLowerCase().indexOf(r.toLowerCase())!==-1)),u!=="all"&&(a=a.filter(n=>n.nccf_order_status===u)),o.length&&(a=a.filter(n=>o.includes(n.commodity))),f.length&&(a=a.filter(n=>f.includes(n.branch))),a}function Ke(){const{vendor:a}=ce();return e.jsxs(e.Fragment,{children:[e.jsx(ze,{children:e.jsx("title",{children:" Dashboard: Order List"})}),(a==null?void 0:a.category)==="branch"?e.jsx($e,{}):e.jsx(qe,{})]})}export{Ke as default};
