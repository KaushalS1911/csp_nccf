import{cd as _,ce as q,r as m,cq as X,a0 as G,aD as Q,a as Y,cO as Z,c as $,es as J,e2 as K,cP as ee,p as f,j as e,C as te,cx as oe,w as F,R as se,i as j,n as A,bW as k,S as B,M as ae,dB as I,cQ as ne,a2 as le,cR as re,ay as ie,bV as ce,cT as de,cc as y,h as S,bX as ue,bY as me,bZ as he,cU as ge,cV as xe,cW as pe,cX as be,cM as fe,e4 as je,H as we}from"./index-nB1sVaXe.js";import{I as w,a as ve,b as Pe,c as Re}from"./invoice-details-view-bRZdNvTg.js";import"./DatePicker-ZM9bsydm.js";import"./custom-date-range-picker-xhBnxnUf.js";import"./address-list-dialog-y8noPMsM.js";function Ce(){const s="http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/commodity",{data:c,isLoading:d,error:p,isValidating:u}=_(s,q);return m.useMemo(()=>({commodities:(c==null?void 0:c.data)||[],commoditiesLoading:d,commoditiesError:p,commoditiesValidating:u,commoditiesEmpty:!d&&!(c!=null&&c.data.length)}),[c==null?void 0:c.data,p,d,u])}const ye=[{id:"invoiceNumber",label:"Customer"},{id:"createDate",label:"Create"},{id:"dueDate",label:"Due"},{id:"price",label:"Amount"},{id:"sent",label:"Sent",align:"center"},{id:"status",label:"Status"},{id:""}],L={name:"",service:[],status:"all",startDate:null,endDate:null};function Se(){const{enqueueSnackbar:s}=X(),{commodities:c}=Ce(),d=G(),p=Q(),u=Y(),t=Z({defaultOrderBy:"createDate"}),x=$(),[i,b]=m.useState(J),[l,a]=m.useState(L),h=K(l.startDate,l.endDate),n=De({inputData:i,comparator:ee(t.order,t.orderBy),filters:l,dateError:h}),v=n.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage),E=t.dense?56:76,T=!!l.name||!!l.service.length||l.status!=="all"||!!l.startDate&&!!l.endDate,V=!n.length&&T||!n.length,g=o=>i.filter(r=>r.status===o).length,P=o=>I(i.filter(r=>r.status===o),"totalAmount"),R=o=>g(o)/i.length*100,O=[{value:"all",label:"All",color:"default",count:i.length},{value:"paid",label:"Paid",color:"success",count:g("paid")},{value:"pending",label:"Pending",color:"warning",count:g("pending")},{value:"overdue",label:"Overdue",color:"error",count:g("overdue")},{value:"draft",label:"Draft",color:"default",count:g("draft")}],C=m.useCallback((o,r)=>{t.onResetPage(),a(D=>({...D,[o]:r}))},[t]),z=m.useCallback(()=>{a(L)},[]),H=m.useCallback(o=>{const r=i.filter(D=>D.id!==o);s("Delete success!"),b(r),t.onUpdatePageDeleteRow(v.length)},[v.length,s,t,i]),W=m.useCallback(()=>{const o=i.filter(r=>!t.selected.includes(r.id));s("Delete success!"),b(o),t.onUpdatePageDeleteRows({totalRowsInPage:v.length,totalRowsFiltered:n.length})},[n.length,v.length,s,t,i]),N=m.useCallback(o=>{u.push(f.dashboard.invoice.edit(o))},[u]),U=m.useCallback(o=>{u.push(f.dashboard.invoice.details(o))},[u]),M=m.useCallback((o,r)=>{C("status",r)},[C]);return e.jsxs(e.Fragment,{children:[e.jsxs(te,{maxWidth:p.themeStretch?!1:"lg",children:[e.jsx(oe,{heading:"Payment",links:[{name:"Dashboard",href:f.dashboard.root},{name:"Payment",href:f.dashboard.invoice.root},{name:"List"}],action:e.jsx(F,{component:se,href:f.dashboard.invoice.new,variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),children:"New Invoice"}),sx:{mb:{xs:3,md:5}}}),e.jsx(A,{sx:{mb:{xs:3,md:5}},children:e.jsx(k,{children:e.jsxs(B,{direction:"row",divider:e.jsx(ae,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:[e.jsx(w,{title:"Total",total:i.length,percent:100,price:I(i,"totalAmount"),icon:"solar:bill-list-bold-duotone",color:d.palette.info.main}),e.jsx(w,{title:"Paid",total:g("paid"),percent:R("paid"),price:P("paid"),icon:"solar:file-check-bold-duotone",color:d.palette.success.main}),e.jsx(w,{title:"Pending",total:g("pending"),percent:R("pending"),price:P("pending"),icon:"solar:sort-by-time-bold-duotone",color:d.palette.warning.main}),e.jsx(w,{title:"Overdue",total:g("overdue"),percent:R("overdue"),price:P("overdue"),icon:"solar:bell-bing-bold-duotone",color:d.palette.error.main}),e.jsx(w,{title:"Draft",total:g("draft"),percent:R("draft"),price:P("draft"),icon:"solar:file-corrupted-bold-duotone",color:d.palette.text.secondary})]})})}),e.jsxs(A,{children:[e.jsx(ne,{value:l.status,onChange:M,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${le(d.palette.grey[500],.08)}`},children:O.map(o=>e.jsx(re,{value:o.value,label:o.label,iconPosition:"end",icon:e.jsx(ie,{variant:(o.value==="all"||o.value===l.status)&&"filled"||"soft",color:o.color,children:o.count})},o.value))}),e.jsx(ve,{filters:l,onFilters:C,dateError:h,serviceOptions:c.map(o=>o.commodity_name)}),T&&e.jsx(Pe,{filters:l,onFilters:C,onResetFilters:z,results:n.length,sx:{p:2.5,pt:0}}),e.jsxs(ce,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(de,{dense:t.dense,numSelected:t.selected.length,rowCount:n.length,onSelectAllRows:o=>{t.onSelectAllRows(o,n.map(r=>r.id))},action:e.jsxs(B,{direction:"row",children:[e.jsx(y,{title:"Sent",children:e.jsx(S,{color:"primary",children:e.jsx(j,{icon:"iconamoon:send-fill"})})}),e.jsx(y,{title:"Download",children:e.jsx(S,{color:"primary",children:e.jsx(j,{icon:"eva:download-outline"})})}),e.jsx(y,{title:"Print",children:e.jsx(S,{color:"primary",children:e.jsx(j,{icon:"solar:printer-minimalistic-bold"})})}),e.jsx(y,{title:"Delete",children:e.jsx(S,{color:"primary",onClick:x.onTrue,children:e.jsx(j,{icon:"solar:trash-bin-trash-bold"})})})]})}),e.jsx(k,{children:e.jsxs(ue,{size:t.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(me,{order:t.order,orderBy:t.orderBy,headLabel:ye,rowCount:n.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:o=>t.onSelectAllRows(o,n.map(r=>r.id))}),e.jsxs(he,{children:[n.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map(o=>e.jsx(Re,{row:o,selected:t.selected.includes(o.id),onSelectRow:()=>t.onSelectRow(o.id),onViewRow:()=>U(o.id),onEditRow:()=>N(o.id),onDeleteRow:()=>H(o.id)},o.id)),e.jsx(ge,{height:E,emptyRows:xe(t.page,t.rowsPerPage,n.length)}),e.jsx(pe,{notFound:V})]})]})})]}),e.jsx(be,{count:n.length,page:t.page,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onRowsPerPageChange:t.onChangeRowsPerPage,dense:t.dense,onChangeDense:t.onChangeDense})]})]}),e.jsx(fe,{open:x.value,onClose:x.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",t.selected.length," "]})," items?"]}),action:e.jsx(F,{variant:"contained",color:"error",onClick:()=>{W(),x.onFalse()},children:"Delete"})})]})}function De({inputData:s,comparator:c,filters:d,dateError:p}){const{name:u,status:t,service:x,startDate:i,endDate:b}=d,l=s.map((a,h)=>[a,h]);return l.sort((a,h)=>{const n=c(a[0],h[0]);return n!==0?n:a[1]-h[1]}),s=l.map(a=>a[0]),u&&(s=s.filter(a=>a.invoiceNumber.toLowerCase().indexOf(u.toLowerCase())!==-1||a.invoiceTo.name.toLowerCase().indexOf(u.toLowerCase())!==-1)),t!=="all"&&(s=s.filter(a=>a.status===t)),x.length&&(s=s.filter(a=>a.items.some(h=>x.includes(h.service)))),p||i&&b&&(s=s.filter(a=>je(a.createDate,i,b))),s}function Ie(){return e.jsxs(e.Fragment,{children:[e.jsx(we,{children:e.jsx("title",{children:" Dashboard: Payment"})}),e.jsx(Se,{})]})}export{Ie as default};
