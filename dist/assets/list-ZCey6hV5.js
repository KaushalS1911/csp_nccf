import{cb as G,cc as $,r as m,co as q,a3 as M,aG as X,a as Y,cW as Z,c as J,eo as K,dY as Q,cX as ee,p as f,j as e,C as te,cv as oe,z as F,R as se,i as j,n as A,bS as k,S as B,U as ae,dv as I,dZ as ne,a5 as le,d_ as re,aB as ie,bR as ce,c_ as de,ca as S,h as y,bT as ue,bU as me,bV as he,c$ as ge,d0 as xe,d1 as pe,d2 as be,cT as fe,e0 as je,H as ve}from"./index-jKnsTm0t.js";import{I as v,a as we,b as Pe,c as Re}from"./invoice-details-view-mfv_-08b.js";import"./DatePicker-GUFurepS.js";import"./custom-date-range-picker-1KRZzp5P.js";import"./address-list-dialog-eLuN_s5t.js";function Ce(){const s="http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/commodity",{data:c,isLoading:d,error:p,isValidating:u}=G(s,$);return m.useMemo(()=>({commodities:(c==null?void 0:c.data)||[],commoditiesLoading:d,commoditiesError:p,commoditiesValidating:u,commoditiesEmpty:!d&&!(c!=null&&c.data.length)}),[c==null?void 0:c.data,p,d,u])}const Se=[{id:"invoiceNumber",label:"Customer"},{id:"createDate",label:"Create"},{id:"dueDate",label:"Due"},{id:"price",label:"Amount"},{id:"sent",label:"Sent",align:"center"},{id:"status",label:"Status"},{id:""}],L={name:"",service:[],status:"all",startDate:null,endDate:null};function ye(){const{enqueueSnackbar:s}=q(),{commodities:c}=Ce(),d=M(),p=X(),u=Y(),t=Z({defaultOrderBy:"createDate"}),x=J(),[i,b]=m.useState(K),[l,a]=m.useState(L),h=Q(l.startDate,l.endDate),n=De({inputData:i,comparator:ee(t.order,t.orderBy),filters:l,dateError:h}),w=n.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage),E=t.dense?56:76,T=!!l.name||!!l.service.length||l.status!=="all"||!!l.startDate&&!!l.endDate,V=!n.length&&T||!n.length,g=o=>i.filter(r=>r.status===o).length,P=o=>I(i.filter(r=>r.status===o),"totalAmount"),R=o=>g(o)/i.length*100,z=[{value:"all",label:"All",color:"default",count:i.length},{value:"paid",label:"Paid",color:"success",count:g("paid")},{value:"pending",label:"Pending",color:"warning",count:g("pending")},{value:"overdue",label:"Overdue",color:"error",count:g("overdue")},{value:"draft",label:"Draft",color:"default",count:g("draft")}],C=m.useCallback((o,r)=>{t.onResetPage(),a(D=>({...D,[o]:r}))},[t]),O=m.useCallback(()=>{a(L)},[]),H=m.useCallback(o=>{const r=i.filter(D=>D.id!==o);s("Delete success!"),b(r),t.onUpdatePageDeleteRow(w.length)},[w.length,s,t,i]),U=m.useCallback(()=>{const o=i.filter(r=>!t.selected.includes(r.id));s("Delete success!"),b(o),t.onUpdatePageDeleteRows({totalRowsInPage:w.length,totalRowsFiltered:n.length})},[n.length,w.length,s,t,i]),_=m.useCallback(o=>{u.push(f.dashboard.invoice.edit(o))},[u]),N=m.useCallback(o=>{u.push(f.dashboard.invoice.details(o))},[u]),W=m.useCallback((o,r)=>{C("status",r)},[C]);return e.jsxs(e.Fragment,{children:[e.jsxs(te,{maxWidth:p.themeStretch?!1:"lg",children:[e.jsx(oe,{heading:"Payment",links:[{name:"Dashboard",href:f.dashboard.root},{name:"Payment",href:f.dashboard.invoice.root},{name:"List"}],action:e.jsx(F,{component:se,href:f.dashboard.invoice.new,variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),children:"New Invoice"}),sx:{mb:{xs:3,md:5}}}),e.jsx(A,{sx:{mb:{xs:3,md:5}},children:e.jsx(k,{children:e.jsxs(B,{direction:"row",divider:e.jsx(ae,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:[e.jsx(v,{title:"Total",total:i.length,percent:100,price:I(i,"totalAmount"),icon:"solar:bill-list-bold-duotone",color:d.palette.info.main}),e.jsx(v,{title:"Paid",total:g("paid"),percent:R("paid"),price:P("paid"),icon:"solar:file-check-bold-duotone",color:d.palette.success.main}),e.jsx(v,{title:"Pending",total:g("pending"),percent:R("pending"),price:P("pending"),icon:"solar:sort-by-time-bold-duotone",color:d.palette.warning.main}),e.jsx(v,{title:"Overdue",total:g("overdue"),percent:R("overdue"),price:P("overdue"),icon:"solar:bell-bing-bold-duotone",color:d.palette.error.main}),e.jsx(v,{title:"Draft",total:g("draft"),percent:R("draft"),price:P("draft"),icon:"solar:file-corrupted-bold-duotone",color:d.palette.text.secondary})]})})}),e.jsxs(A,{children:[e.jsx(ne,{value:l.status,onChange:W,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${le(d.palette.grey[500],.08)}`},children:z.map(o=>e.jsx(re,{value:o.value,label:o.label,iconPosition:"end",icon:e.jsx(ie,{variant:(o.value==="all"||o.value===l.status)&&"filled"||"soft",color:o.color,children:o.count})},o.value))}),e.jsx(we,{filters:l,onFilters:C,dateError:h,serviceOptions:c.map(o=>o.commodity_name)}),T&&e.jsx(Pe,{filters:l,onFilters:C,onResetFilters:O,results:n.length,sx:{p:2.5,pt:0}}),e.jsxs(ce,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(de,{dense:t.dense,numSelected:t.selected.length,rowCount:n.length,onSelectAllRows:o=>{t.onSelectAllRows(o,n.map(r=>r.id))},action:e.jsxs(B,{direction:"row",children:[e.jsx(S,{title:"Sent",children:e.jsx(y,{color:"primary",children:e.jsx(j,{icon:"iconamoon:send-fill"})})}),e.jsx(S,{title:"Download",children:e.jsx(y,{color:"primary",children:e.jsx(j,{icon:"eva:download-outline"})})}),e.jsx(S,{title:"Print",children:e.jsx(y,{color:"primary",children:e.jsx(j,{icon:"solar:printer-minimalistic-bold"})})}),e.jsx(S,{title:"Delete",children:e.jsx(y,{color:"primary",onClick:x.onTrue,children:e.jsx(j,{icon:"solar:trash-bin-trash-bold"})})})]})}),e.jsx(k,{children:e.jsxs(ue,{size:t.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(me,{order:t.order,orderBy:t.orderBy,headLabel:Se,rowCount:n.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:o=>t.onSelectAllRows(o,n.map(r=>r.id))}),e.jsxs(he,{children:[n.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map(o=>e.jsx(Re,{row:o,selected:t.selected.includes(o.id),onSelectRow:()=>t.onSelectRow(o.id),onViewRow:()=>N(o.id),onEditRow:()=>_(o.id),onDeleteRow:()=>H(o.id)},o.id)),e.jsx(ge,{height:E,emptyRows:xe(t.page,t.rowsPerPage,n.length)}),e.jsx(pe,{notFound:V})]})]})})]}),e.jsx(be,{count:n.length,page:t.page,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onRowsPerPageChange:t.onChangeRowsPerPage,dense:t.dense,onChangeDense:t.onChangeDense})]})]}),e.jsx(fe,{open:x.value,onClose:x.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",t.selected.length," "]})," items?"]}),action:e.jsx(F,{variant:"contained",color:"error",onClick:()=>{U(),x.onFalse()},children:"Delete"})})]})}function De({inputData:s,comparator:c,filters:d,dateError:p}){const{name:u,status:t,service:x,startDate:i,endDate:b}=d,l=s.map((a,h)=>[a,h]);return l.sort((a,h)=>{const n=c(a[0],h[0]);return n!==0?n:a[1]-h[1]}),s=l.map(a=>a[0]),u&&(s=s.filter(a=>a.invoiceNumber.toLowerCase().indexOf(u.toLowerCase())!==-1||a.invoiceTo.name.toLowerCase().indexOf(u.toLowerCase())!==-1)),t!=="all"&&(s=s.filter(a=>a.status===t)),x.length&&(s=s.filter(a=>a.items.some(h=>x.includes(h.service)))),p||i&&b&&(s=s.filter(a=>je(a.createDate,i,b))),s}function Ie(){return e.jsxs(e.Fragment,{children:[e.jsx(ve,{children:e.jsx("title",{children:" Dashboard: Payment"})}),e.jsx(ye,{})]})}export{Ie as default};
