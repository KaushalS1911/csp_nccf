import{r as c,u as T,K as S,f as $,j as e,bs as K,cP as O,bt as G,F as J,bu as M,N as X,g as Y,bv as Z,D as _,M as v,cn as ee,aF as k,a as te,c as se,cQ as oe,cR as ne,aJ as re,C as E,cu as ce,R as le,i as L,q as ae,cS as ie,cT as de,cU as ue,cV as me,bQ as he,cW as ge,c9 as xe,h as pe,bR as fe,bS as be,bT as je,bU as ye,cX as Ce,cY as we,cZ as Se,c_ as Pe,c$ as Re,d0 as _e,d1 as Te,a8 as d,ah as y,d2 as R,a2 as Fe,d3 as D,d4 as q,d5 as H,d6 as z,H as Oe,d7 as ve}from"./index-kourVlqX.js";function Ae({editDialogOpen:n,setEditDialogOpen:u,editData:o,dataFiltered:i,fetchAllOrdersDemo:f}){const[g,t]=c.useState([]),{vendor:C}=T();c.useState({}),c.useEffect(()=>{a()},[]);function a(){S.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/commodity").then(h=>{var s;t((s=h.data)==null?void 0:s.data)})}const x=$({defaultValues:{csp_code:"",commodity:"",quantity:""}}),{reset:b,handleSubmit:w,formState:{isSubmitting:j}}=x;c.useEffect(()=>{o&&b({csp_code:o==null?void 0:o.csp_code,commodity:o==null?void 0:o.commodity,quantity:o==null?void 0:o.quantity})},[o]);const p=async h=>{u(!1);const s={...h,csp_code:C.csp_code,mode:"test",status:"0"};try{const r=await S.post("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/create_order",s);r.data.status=="201"?(v("Order added successfully!"),f()):r.data.status=="400"&&v("Failed to add order.",{variant:"error"})}catch(r){console.error("Order creation error:",r),v("Order creation failed.",{variant:"error"})}};return e.jsx(K,{open:n,fullWidth:!0,maxWidth:"md",onClose:()=>u(!1),children:e.jsxs(O,{sx:{py:5,px:3},children:[e.jsx(G,{children:"Edit Order"}),e.jsxs(J,{methods:x,children:[e.jsxs(M,{maxWidth:"lg ",children:[e.jsx(O,{mb:2,mt:1,children:e.jsx(X,{name:"commodity",type:"commodity",label:"Commodity",placeholder:"Choose Commodity",fullWidth:!0,options:g.map(h=>h==null?void 0:h.commodity_name),getOptionLabel:h=>h})}),e.jsx(O,{mt:2,children:e.jsx(Y,{name:"quantity",label:"Quantity",fullWidth:!0})})]}),e.jsxs(Z,{children:[e.jsx(_,{onClick:()=>u(!1),variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(_,{variant:"contained",onClick:w(p),children:"Save"})]})]})]})})}const ke=[{id:"srNo",label:"Sr No",width:100},{id:"commodity",label:"Commodity",width:200},{id:"quantity",label:"Quantity",width:200},{id:"created_at",label:"Date",width:180},{id:"status",label:"Status",width:100},{id:"",width:88}],A={name:"",commodity:[],order_status:[],status:"all"};function Ee({tableData:n,fetchAllOrdersDemo:u}){const{enqueueSnackbar:o}=ee(),i=k(),f=te(),g=se(),t=oe(),[C,a]=c.useState(!1),[x,b]=c.useState(0),[w,j]=c.useState(A),[p,h]=c.useState({}),s=Be({inputData:n,comparator:ne(t.order,t.orderBy),filters:w}),r=s.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage),B=t.dense?56:76,W=!re(A,w),U=!s.length&&W||!s.length,P=c.useCallback((l,m)=>{t.onResetPage(),j(F=>({...F,[l]:m}))},[t]),I=c.useCallback(()=>{j(A)},[]),N=c.useCallback(l=>{const m=n.filter(F=>F.id!==l);o("Delete success!"),setTableData(m),t.onUpdatePageDeleteRow(r.length)},[r.length,o,t,n]),V=c.useCallback(()=>{const l=n.filter(m=>!t.selected.includes(m.id));o("Delete success!"),setTableData(l),t.onUpdatePageDeleteRows({totalRowsInPage:r.length,totalRowsFiltered:s.length})},[s.length,r.length,o,t,n]),Q=c.useCallback(l=>{b(l==null?void 0:l.id),h(l)},[f]);return c.useCallback((l,m)=>{P("status",m)},[P]),c.useCallback(l=>{setTableData(m=>[...m,l])},[o]),e.jsxs(e.Fragment,{children:[e.jsxs(E,{maxWidth:i.themeStretch?!1:"xxl",children:[e.jsx(ce,{heading:"Orders",links:[{name:""}],action:e.jsx(_,{component:le,variant:"contained",startIcon:e.jsx(L,{icon:"mingcute:add-line"}),onClick:()=>{a(!0)},children:"Add Order"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(ae,{children:[e.jsx(ie,{filters:w,onFilters:P,commodityOptions:de,orderStatusOptions:ue}),W&&e.jsx(me,{filters:w,onFilters:P,onResetFilters:I,results:s.length,sx:{p:2.5,pt:0}}),e.jsxs(he,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(ge,{dense:!0,numSelected:t.selected.length,rowCount:s.length,onSelectAllRows:l=>t.onSelectAllRows(l,s.map(m=>m.id)),action:e.jsx(xe,{title:"Delete",children:e.jsx(pe,{color:"primary",onClick:g.onTrue,children:e.jsx(L,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(fe,{children:e.jsxs(be,{size:t.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(je,{order:t.order,orderBy:t.orderBy,headLabel:ke,rowCount:s.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:l=>t.onSelectAllRows(l,s.map(m=>m.id))}),e.jsxs(ye,{children:[s.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map((l,m)=>e.jsx(Ce,{row:{...l,index:m},selected:t.selected.includes(l.id),onSelectRow:()=>t.onSelectRow(l.id),onDeleteRow:()=>N(l.id),onEditRow:()=>Q(l)},l.id)),e.jsx(we,{height:B,emptyRows:Se(t.page,t.rowsPerPage,n.length)}),e.jsx(Pe,{isNotFound:U})]})]})}),e.jsx(Re,{count:s.length,page:t.page,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onRowsPerPageChange:t.onChangeRowsPerPage,dense:t.dense,onChangeDense:t.onChangeDense})]})]})]}),e.jsx(_e,{open:g.value,onClose:g.onFalse,title:"Delete",content:"Are you sure you want to delete?",action:e.jsx(_,{variant:"contained",color:"error",onClick:()=>{V(),g.onFalse()},children:"Delete"})}),e.jsx(Te,{dialogOpen:C,setDialogOpen:a,editId:p,fetchAllOrdersDemo:u}),e.jsx(Ae,{editDialogOpen:x,setEditDialogOpen:b,editData:p,dataFiltered:s,fetchAllOrdersDemo:u})]})}function Be({inputData:n,comparator:u,filters:o}){const{name:i,status:f,commodity:g,order_status:t}=o,C=n.map((a,x)=>[a,x]);return C.sort((a,x)=>{const b=u(a[0],x[0]);return b!==0?b:a[1]-x[1]}),n=C.map(a=>a[0]),i&&(n=n.filter(a=>a.commodity.toLowerCase().includes(i.toLowerCase()))),f!=="all"&&(n=n.filter(a=>a.status===f)),g.length&&(n=n.filter(a=>g.includes(a.commodity))),t.length&&(n=n.filter(a=>t.includes(a.nccf_order_status))),n}d.string,d.array,d.array,d.string;d.object;function We({vendorCode:n}){const{vendor:u}=T(),o=k(),[i,f]=c.useState({}),[g,t]=c.useState([]),[C,a]=c.useState(0);c.useEffect(()=>{u.csp_code&&(w(),b())},[C]);function x(){a(j=>j+1)}function b(){S.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${u.csp_code}/orders_stats`).then(j=>{var p;f((p=j.data)==null?void 0:p.data[0])})}function w(){S.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${u.csp_code}/orders`).then(j=>{var p;t((p=j.data)==null?void 0:p.data)})}return e.jsx(E,{maxWidth:o.themeStretch?!1:"xl",children:e.jsxs(y,{container:!0,spacing:3,children:[e.jsx(y,{xs:12,md:3,children:e.jsx(R,{title:"Total Orders",total:(i==null?void 0:i.total_orders)||"0"})}),e.jsx(y,{xs:12,md:3,children:e.jsx(R,{title:"Orders Pending",total:(i==null?void 0:i.placed_orders)||"0"})}),e.jsx(y,{xs:12,md:3,children:e.jsx(R,{title:"Orders Accepted",total:(i==null?void 0:i.accepted_orders)||"0"})}),e.jsx(y,{xs:12,md:3,children:e.jsx(R,{title:"Orders Declined",total:(i==null?void 0:i.declined_orders)||"0"})}),e.jsx(y,{xs:12,lg:12,children:e.jsx(Ee,{tableData:g,fetchAllOrdersDemo:x})})]})})}d.object,d.number,d.object,d.string,d.number;d.object,d.string,d.string;d.bool,d.string,d.func,d.func,d.string,d.object,d.string;function Le({vendorCode:n}){T();const u=k();Fe(),c.useState([]);const[o,i]=c.useState([]),[f,g]=c.useState([]),[t,C]=c.useState([]);c.useEffect(()=>{a(),x()},[]),c.useEffect(()=>{const s=o==null?void 0:o.map((r,B)=>(r==null?void 0:r.category)!=="Distributor"?{label:D(r==null?void 0:r.category),value:r==null?void 0:r.count}:null).filter(r=>r!==null);C(s)},[o]);function a(){S.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/ho/csp/category-stats").then(s=>{i(s.data.data)})}function x(){S.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/ho/csp/orders/stats").then(s=>{g(s.data.data)})}const b=["placed","accepted","declined"],w=["primary","info","warning","error"],j=["secondary","brown1","brown","brown"],p=f.filter(s=>b.includes(s.nccf_order_status)),h=[];return p.map(s=>h.push({label:q(s==null?void 0:s.nccf_order_status),value:(s==null?void 0:s.order_count)||0})),e.jsx(E,{maxWidth:u.themeStretch?!1:"xl",children:e.jsxs(y,{container:!0,spacing:3,children:[o&&o.map((s,r)=>e.jsx(y,{xs:12,md:3,children:e.jsx(H,{title:D(s==null?void 0:s.category),total:(s==null?void 0:s.count)||0,color:w[r]})})),f&&p.map((s,r)=>e.jsx(y,{xs:12,md:4,children:e.jsx(H,{title:q(s==null?void 0:s.nccf_order_status),total:(s==null?void 0:s.order_count)||0,color:j[r],chart:{}})})),e.jsx(y,{xs:12,md:6,lg:4,children:t!==[]&&e.jsx(z,{title:"CSP distribution",chart:{colors:["#5DD095","#0D7566","#004B50","#C8FAD6"],series:t}})}),e.jsx(y,{xs:12,md:6,lg:4,children:t!==[]&&e.jsx(z,{title:"Total Orders",chart:{colors:["#6F4E37","#A67B5B","#FED8B1","#ECB176"],series:h}})})]})})}function qe(){const{vendor:n}=T(),u=localStorage.getItem("login_type");return e.jsxs(e.Fragment,{children:[e.jsx(Oe,{children:e.jsx("title",{children:" NCCF CSP Portal "})}),u==="other-login"?e.jsx(We,{}):(n==null?void 0:n.category)==="branch"?e.jsx(ve,{}):e.jsx(Le,{})]})}export{qe as default};
