import{r as h,u as O,K as S,f as te,j as e,bs as se,cN as A,bt as ae,F as oe,bu as re,N as ne,g as le,bv as ie,D as k,M as B,cn as ce,aF as H,a as de,c as he,cO as ue,cP as me,aJ as pe,C as L,cu as xe,R as ge,i as W,q as _,cQ as be,cR as fe,cS as je,cT as ye,bQ as we,cU as Ce,c9 as Se,h as ve,bR as Re,bS as Te,bT as Pe,bU as ke,cV as Oe,cW as _e,cX as Fe,cY as Ae,cZ as Be,c_ as De,c$ as Ee,a8 as u,ah as y,d0 as P,a2 as I,d1 as R,B as $,T as D,S as We,ai as He,d2 as M,d3 as U,bK as V,ay as Le,br as Ie,d4 as Me,bd as ze,bw as Ne,cd as qe,H as $e,d5 as Ue}from"./index-3ssIgQbK.js";function Ve({editDialogOpen:s,setEditDialogOpen:l,editData:r,dataFiltered:a,fetchAllOrdersDemo:f}){const[p,t]=h.useState([]),{vendor:g}=O();h.useState({}),h.useEffect(()=>{o()},[]);function o(){S.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/commodity").then(w=>{var b;t((b=w.data)==null?void 0:b.data)})}const i=te({defaultValues:{csp_code:"",commodity:"",quantity:""}}),{reset:n,handleSubmit:m,formState:{isSubmitting:x}}=i;h.useEffect(()=>{r&&n({csp_code:r==null?void 0:r.csp_code,commodity:r==null?void 0:r.commodity,quantity:r==null?void 0:r.quantity})},[r]);const c=async w=>{l(!1);const b={...w,csp_code:g.csp_code,mode:"test",status:"0"};try{const C=await S.post("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/create_order",b);C.data.status=="201"?(B("Order added successfully!"),f()):C.data.status=="400"&&B("Failed to add order.",{variant:"error"})}catch(C){console.error("Order creation error:",C),B("Order creation failed.",{variant:"error"})}};return e.jsx(se,{open:s,fullWidth:!0,maxWidth:"md",onClose:()=>l(!1),children:e.jsxs(A,{sx:{py:5,px:3},children:[e.jsx(ae,{children:"Edit Order"}),e.jsxs(oe,{methods:i,children:[e.jsxs(re,{maxWidth:"lg ",children:[e.jsx(A,{mb:2,mt:1,children:e.jsx(ne,{name:"commodity",type:"commodity",label:"Commodity",placeholder:"Choose Commodity",fullWidth:!0,options:p.map(w=>w==null?void 0:w.commodity_name),getOptionLabel:w=>w})}),e.jsx(A,{mt:2,children:e.jsx(le,{name:"quantity",label:"Quantity",fullWidth:!0})})]}),e.jsxs(ie,{children:[e.jsx(k,{onClick:()=>l(!1),variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(k,{variant:"contained",onClick:m(c),children:"Save"})]})]})]})})}const Ge=[{id:"srNo",label:"Sr No",width:100},{id:"commodity",label:"Commodity",width:200},{id:"quantity",label:"Quantity",width:200},{id:"created_at",label:"Date",width:180},{id:"status",label:"Status",width:100},{id:"",width:88}],E={name:"",commodity:[],order_status:[],status:"all"};function Je({tableData:s,fetchAllOrdersDemo:l}){const{enqueueSnackbar:r}=ce(),a=H(),f=de(),p=he(),t=ue(),[g,o]=h.useState(!1),[i,n]=h.useState(0),[m,x]=h.useState(E),[c,w]=h.useState({}),b=Qe({inputData:s,comparator:me(t.order,t.orderBy),filters:m}),C=b.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage),Q=t.dense?56:76,z=!pe(E,m),Y=!b.length&&z||!b.length,T=h.useCallback((d,j)=>{t.onResetPage(),x(F=>({...F,[d]:j}))},[t]),K=h.useCallback(()=>{x(E)},[]),X=h.useCallback(d=>{const j=s.filter(F=>F.id!==d);r("Delete success!"),setTableData(j),t.onUpdatePageDeleteRow(C.length)},[C.length,r,t,s]),Z=h.useCallback(()=>{const d=s.filter(j=>!t.selected.includes(j.id));r("Delete success!"),setTableData(d),t.onUpdatePageDeleteRows({totalRowsInPage:C.length,totalRowsFiltered:b.length})},[b.length,C.length,r,t,s]),ee=h.useCallback(d=>{n(d==null?void 0:d.id),w(d)},[f]);return h.useCallback((d,j)=>{T("status",j)},[T]),h.useCallback(d=>{setTableData(j=>[...j,d])},[r]),e.jsxs(e.Fragment,{children:[e.jsxs(L,{maxWidth:a.themeStretch?!1:"xxl",children:[e.jsx(xe,{heading:"Orders",links:[{name:""}],action:e.jsx(k,{component:ge,variant:"contained",startIcon:e.jsx(W,{icon:"mingcute:add-line"}),onClick:()=>{o(!0)},children:"Add Order"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(_,{children:[e.jsx(be,{filters:m,onFilters:T,commodityOptions:fe,orderStatusOptions:je}),z&&e.jsx(ye,{filters:m,onFilters:T,onResetFilters:K,results:b.length,sx:{p:2.5,pt:0}}),e.jsxs(we,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(Ce,{dense:!0,numSelected:t.selected.length,rowCount:b.length,onSelectAllRows:d=>t.onSelectAllRows(d,b.map(j=>j.id)),action:e.jsx(Se,{title:"Delete",children:e.jsx(ve,{color:"primary",onClick:p.onTrue,children:e.jsx(W,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(Re,{children:e.jsxs(Te,{size:t.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Pe,{order:t.order,orderBy:t.orderBy,headLabel:Ge,rowCount:b.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:d=>t.onSelectAllRows(d,b.map(j=>j.id))}),e.jsxs(ke,{children:[b.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map((d,j)=>e.jsx(Oe,{row:{...d,index:j},selected:t.selected.includes(d.id),onSelectRow:()=>t.onSelectRow(d.id),onDeleteRow:()=>X(d.id),onEditRow:()=>ee(d)},d.id)),e.jsx(_e,{height:Q,emptyRows:Fe(t.page,t.rowsPerPage,s.length)}),e.jsx(Ae,{isNotFound:Y})]})]})}),e.jsx(Be,{count:b.length,page:t.page,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onRowsPerPageChange:t.onChangeRowsPerPage,dense:t.dense,onChangeDense:t.onChangeDense})]})]})]}),e.jsx(De,{open:p.value,onClose:p.onFalse,title:"Delete",content:"Are you sure you want to delete?",action:e.jsx(k,{variant:"contained",color:"error",onClick:()=>{Z(),p.onFalse()},children:"Delete"})}),e.jsx(Ee,{dialogOpen:g,setDialogOpen:o,editId:c,fetchAllOrdersDemo:l}),e.jsx(Ve,{editDialogOpen:i,setEditDialogOpen:n,editData:c,dataFiltered:b,fetchAllOrdersDemo:l})]})}function Qe({inputData:s,comparator:l,filters:r}){const{name:a,status:f,commodity:p,order_status:t}=r,g=s.map((o,i)=>[o,i]);return g.sort((o,i)=>{const n=l(o[0],i[0]);return n!==0?n:o[1]-i[1]}),s=g.map(o=>o[0]),a&&(s=s.filter(o=>o.commodity.toLowerCase().includes(a.toLowerCase()))),f!=="all"&&(s=s.filter(o=>o.status===f)),p.length&&(s=s.filter(o=>p.includes(o.commodity))),t.length&&(s=s.filter(o=>t.includes(o.nccf_order_status))),s}u.string,u.array,u.array,u.string;u.object;function Ye({vendorCode:s}){const{vendor:l}=O(),r=H(),[a,f]=h.useState({}),[p,t]=h.useState([]),[g,o]=h.useState(0);h.useEffect(()=>{l.csp_code&&(m(),n())},[g]);function i(){o(x=>x+1)}function n(){S.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${l.csp_code}/orders_stats`).then(x=>{var c;f((c=x.data)==null?void 0:c.data[0])})}function m(){S.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${l.csp_code}/orders`).then(x=>{var c;t((c=x.data)==null?void 0:c.data)})}return e.jsx(L,{maxWidth:r.themeStretch?!1:"xl",children:e.jsxs(y,{container:!0,spacing:3,children:[e.jsx(y,{xs:12,md:3,children:e.jsx(P,{title:"Total Orders",total:(a==null?void 0:a.total_orders)||"0"})}),e.jsx(y,{xs:12,md:3,children:e.jsx(P,{title:"Orders Pending",total:(a==null?void 0:a.placed_orders)||"0"})}),e.jsx(y,{xs:12,md:3,children:e.jsx(P,{title:"Orders Accepted",total:(a==null?void 0:a.accepted_orders)||"0"})}),e.jsx(y,{xs:12,md:3,children:e.jsx(P,{title:"Orders Declined",total:(a==null?void 0:a.declined_orders)||"0"})}),e.jsx(y,{xs:12,lg:12,children:e.jsx(Je,{tableData:p,fetchAllOrdersDemo:i})})]})})}function v({title:s,percent:l,total:r,chart:a,sx:f,...p}){const t=I(),{colors:g=[t.palette.primary.light,t.palette.primary.main],series:o,options:i}=a,n={colors:g.map(m=>m[1]),fill:{type:"gradient",gradient:{colorStops:[{offset:0,color:g[0],opacity:1},{offset:100,color:g[1],opacity:1}]}},chart:{sparkline:{enabled:!0}},plotOptions:{bar:{columnWidth:"68%",borderRadius:2}},tooltip:{x:{show:!1},y:{formatter:m=>R(m),title:{formatter:()=>""}},marker:{show:!1}},...i};return e.jsxs(_,{sx:{display:"flex",alignItems:"center",p:3,...f},...p,children:[e.jsxs($,{sx:{flexGrow:1},children:[e.jsx(D,{variant:"subtitle2",children:s}),e.jsx(We,{direction:"row",alignItems:"center",sx:{mt:2,mb:1},children:e.jsxs(D,{component:"div",variant:"subtitle2",children:[l>0&&"+",He(l)]})}),e.jsx(D,{variant:"h3",children:R(r)})]}),e.jsx(M,{dir:"ltr",type:"bar",series:[{data:o}],options:n,width:60,height:36})]})}v.propTypes={chart:u.object,percent:u.number,sx:u.object,title:u.string,total:u.number};const N=400,q=72,Ke=Le(M)(({theme:s})=>({height:N,"& .apexcharts-canvas, .apexcharts-inner, svg, foreignObject":{height:"100% !important"},"& .apexcharts-legend":{height:q,borderTop:`dashed 1px ${s.palette.divider}`,top:`calc(${N-q}px) !important`}}));function G({title:s,subheader:l,chart:r,...a}){const f=I(),{colors:p,series:t,options:g}=r,o=t.map(n=>n.value),i=U({chart:{sparkline:{enabled:!0}},colors:p,labels:t.map(n=>n.label),stroke:{colors:[f.palette.background.paper]},legend:{offsetY:0,floating:!0,position:"bottom",horizontalAlign:"center"},tooltip:{fillSeriesColor:!1,y:{formatter:n=>R(n),title:{formatter:n=>`${n}`}}},plotOptions:{pie:{donut:{size:"70%",labels:{value:{formatter:n=>R(n)},total:{formatter:n=>{const m=n.globals.seriesTotals.reduce((x,c)=>x+c,0);return R(m)}}}}}},...g});return e.jsxs(_,{...a,children:[e.jsx(V,{title:s,subheader:l,sx:{mb:5}}),e.jsx(Ke,{dir:"ltr",type:"donut",series:o,options:i,width:"100%",height:280})]})}G.propTypes={chart:u.object,subheader:u.string,title:u.string};function J({title:s,subheader:l,chart:r,...a}){const{labels:f,colors:p,series:t,options:g}=r,o=Ie(),[i,n]=h.useState("Week"),m=U({chart:{stacked:!0},colors:p,stroke:{width:0},xaxis:{categories:i==="Week"&&f.week||i==="Month"&&f.month||f.year},tooltip:{y:{formatter:c=>Me(c)}},plotOptions:{bar:{borderRadius:i==="Week"&&8||i==="Month"&&6||10,columnWidth:"20%"}},...g}),x=h.useCallback(c=>{o.onClose(),n(c)},[o]);return e.jsxs(e.Fragment,{children:[e.jsxs(_,{...a,children:[e.jsx(V,{title:s,subheader:l,action:e.jsxs(ze,{onClick:o.onOpen,sx:{pl:1,py:.5,pr:.5,borderRadius:1,typography:"subtitle2",bgcolor:"background.neutral"},children:[i,e.jsx(W,{width:16,icon:o.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",sx:{ml:.5}})]})}),t.map(c=>e.jsx($,{sx:{mt:3,mx:3},children:c.type===i&&e.jsx(M,{dir:"ltr",type:"bar",series:c.data,options:m,width:"100%",height:375})},c.type))]}),e.jsx(Ne,{open:o.open,onClose:o.onClose,sx:{width:140},children:t.map(c=>e.jsx(qe,{selected:c.type===i,onClick:()=>x(c.type),children:c.type},c.type))})]})}J.propTypes={chart:u.object,subheader:u.string,title:u.string};u.bool,u.string,u.func,u.func,u.string,u.object,u.string;function Xe({vendorCode:s}){const{vendor:l}=O(),r=H(),a=I(),[f,p]=h.useState([]),[t,g]=h.useState({}),o={week:["Mon","Tue","Web","Thu","Fri","Sat","Sun"],month:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],year:["2018","2019","2020","2021","2022"]};h.useEffect(()=>{l.csp_code&&(n(),i())},[l]);function i(){S.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${l.csp_code}/orders_stats`).then(m=>{var x;g((x=m.data)==null?void 0:x.data[0])})}function n(){S.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${l.csp_code}/orders`).then(m=>{var x;p((x=m.data)==null?void 0:x.data)})}return e.jsx(L,{maxWidth:r.themeStretch?!1:"xl",children:e.jsxs(y,{container:!0,spacing:3,children:[e.jsx(y,{xs:12,md:3,children:e.jsx(v,{title:"Miller",total:4876,chart:{series:[8,9,31,8,16,37,8,33,46,31]}})}),e.jsx(y,{xs:12,md:3,children:e.jsx(v,{title:"Distributor",total:678,chart:{colors:[a.palette.warning.light,a.palette.warning.main],series:[8,9,31,8,16,37,8,33,46,31]}})}),e.jsx(y,{xs:12,md:3,children:e.jsx(v,{title:"Miller & Distributor",total:4876,chart:{colors:[a.palette.info.light,a.palette.info.main],series:[20,41,63,33,28,35,50,46,11,26]}})}),e.jsx(y,{xs:12,md:3,children:e.jsx(v,{title:"Society/Co-operative",total:678,chart:{colors:[a.palette.secondary.light,a.palette.secondary.main],series:[8,9,31,8,16,37,8,33,46,31]}})}),e.jsx(y,{xs:12,md:6,lg:4,children:e.jsx(G,{title:"Current Orders",chart:{colors:["#5DD095","#0D7566","#004B50","#C8FAD6"],series:[{label:"Miller",value:12244},{label:"Distributor",value:53345},{label:"Miller + Distributor",value:44313},{label:"Society/Co-operative",value:78343}]}})}),e.jsx(y,{xs:12,md:6,lg:8,children:e.jsx(J,{title:"Orders",chart:{labels:o,colors:[a.palette.primary.main,a.palette.error.main,a.palette.warning.main],series:[{type:"Week",data:[{name:"Bharat Daal",data:[20,34,48,65,37,48,9]},{name:"Bharat Aata",data:[10,34,13,26,27,28,18]},{name:"Bharat Rice",data:[10,14,13,16,17,18,28]}]},{type:"Month",data:[{name:"Bharat Daal",data:[10,34,13,56,77,88,99,77,45,12,43,34]},{name:"Bharat Aata",data:[10,34,13,56,77,88,99,77,45,12,43,34]},{name:"Bharat Rice",data:[10,34,13,56,77,88,99,77,45,12,43,34]}]},{type:"Year",data:[{name:"Bharat Daal",data:[10,34,13,56,77]},{name:"Bharat Aata",data:[10,34,13,56,77]},{name:"Bharat Rice",data:[10,34,13,56,77]}]}]}})})]})})}function et(){const{vendor:s}=O(),l=localStorage.getItem("login_type");return e.jsxs(e.Fragment,{children:[e.jsx($e,{children:e.jsx("title",{children:" NCCF CSP Portal "})}),l==="other-login"?e.jsx(Ye,{}):(s==null?void 0:s.category)==="branch"?e.jsx(Ue,{}):e.jsx(Xe,{})]})}export{et as default};
