import{cn as ue,c as he,a as fe,aF as me,u as re,r as a,dZ as z,K as _,aJ as xe,j as e,C as ge,cu as be,p as $,d_ as Ne,q as pe,d$ as je,a4 as Ce,e0 as we,aA as W,dI as _e,dJ as ye,E as ae,cG as le,cH as ne,cI as ce,cd as oe,e1 as Le,S as Se,D as P,i as ve,dN as De,dP as ke,e2 as Ee,e3 as Oe,aV as G,d0 as Fe,e4 as U,cP as Ae,e5 as Re,bN as H,e6 as Be,e7 as Ie,e8 as Me,e9 as He,ea as ze,H as $e}from"./index-1vZKvBC1.js";const te={publish:[],stock:[],commodity:[],status:"all",branch:[],name:"",startDate:null,endDate:null,startDay:null,endDay:null},We={category:!1},Ge=["category","actions"];function Ue({singleCode:l}){const{enqueueSnackbar:m}=ue(),x=he(),O=fe(),j=me(),{vendor:r}=re(),[u,c]=a.useState([]),[i,f]=a.useState(te),[g,y]=a.useState([]),[b,C]=a.useState(!1),[n,de]=a.useState({}),[L,ie]=a.useState(!1),[V,Y]=a.useState(We),[q,w]=a.useState([]),[F,Q]=a.useState([]),[E,S]=a.useState([]),T=z(i.startDate,i.endDate),J=z(i.startDay,i.endDay),B=s=>{const d=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${s}/orders`;_.get(d).then(h=>{var k;return c((k=h==null?void 0:h.data)==null?void 0:k.data)}).catch(h=>console.log(h))};a.useEffect(()=>{r&&(_.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080//nccf/branch/${r==null?void 0:r.branch}/csp/list`).then(s=>{var k;const d=((k=s==null?void 0:s.data)==null?void 0:k.data)||[],h=[{name:"All",csp_code:"All"},...d];w(h)}).catch(s=>console.log(s)),_.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${r==null?void 0:r.branch}/order`).then(s=>{var d;return c((d=s==null?void 0:s.data)==null?void 0:d.data)}).catch(s=>console.log(s)))},[]),a.useEffect(()=>{if(F==="All"){const s=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${r==null?void 0:r.branch}/order`;_.get(s).then(d=>{var h;return c((h=d==null?void 0:d.data)==null?void 0:h.data)}).catch(d=>console.log(d))}else B(F)},[F]);const v=Ve({inputData:u,filters:i,dateError:T}),K=a.useCallback(s=>{S(s.target.value),Q(s.target.value)},[F]),I=!xe(te,i)||!!i.startDate&&!!i.endDate||!!i.startDay&&!!i.endDay,D=a.useCallback((s,d)=>{f(h=>({...h,[s]:d}))},[]),A=a.useCallback(()=>{f(te)},[]);a.useCallback(s=>{const d=u.filter(h=>h.id!==s);m("Delete success!"),c(d)},[m,u]);const Z=[{value:"all",label:"All"},{value:"1",label:"Accepted"},{value:"placed",label:"Placed"},{value:"0",label:"Declined"}],X=a.useCallback(()=>{const s=u.filter(d=>!g.includes(d.id));m("Delete success!"),c(s)},[m,g,u]);a.useCallback(s=>{},[O]);const M=[{field:"id",headerName:"#",minWidth:200,renderCell:s=>e.jsx(Ae,{children:s.row.id})},{field:"commodity",headerName:"Commodity",minWidth:150,flex:1},{field:"quantity",headerName:"Quantity",minWidth:100,flex:1},{field:"created_at",headerName:"Date",minWidth:150,flex:1,renderCell:s=>Re(s.row.created_at).format("DD/MM/YYYY")},{field:"nccf_order_status",headerName:"Order Status",minWidth:100,flex:1,renderCell:s=>e.jsx(H,{children:e.jsx(W,{variant:"soft",color:s.row.nccf_order_status==="1"&&"success"||s.row.nccf_order_status==="placed"&&"warning"||s.row.nccf_order_status==="0"&&"error"||"default",children:s.row.nccf_order_status==="1"?"Approved":s.row.nccf_order_status==="0"?"Rejected":"Placed"})})}],ee=a.useCallback((s,d)=>{D("status",d)},[D]),R=()=>M.filter(s=>!Ge.includes(s.field)).map(s=>s.field);return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{maxWidth:j.themeStretch?!1:"xl",children:[e.jsx(be,{heading:"Order List",links:[{name:"Dashboard",href:$.dashboard.root},{name:"Order",href:$.dashboard.orders},{name:"List"}],sx:{mb:{xs:3,md:5}}}),e.jsx(Ne,{getAllDocument:B,currentUser:n,open:b,setOpen:C,approve:L,cspCode:E}),e.jsxs(pe,{sx:{height:(v==null?void 0:v.length)>0?"unset":700,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[e.jsx(je,{value:i.status,onChange:ee,sx:{px:2.5,boxShadow:s=>`inset 0 -2px 0 0 ${Ce(s.palette.grey[500],.08)}`},children:Z.map(s=>e.jsx(we,{iconPosition:"end",value:s.value,label:s.label,icon:e.jsx(W,{variant:(s.value==="all"||s.value===i.status)&&"filled"||"soft",color:s.value==="1"&&"success"||s.value==="placed"&&"warning"||s.value==="0"&&"error"||"default",children:["1","0","placed"].includes(s.value)?u.filter(d=>d.nccf_order_status===s.value).length:u.length})},s.value))}),e.jsx(_e,{disableRowSelectionOnClick:!0,rows:v,columns:M,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:5}}},columnVisibilityModel:V,onColumnVisibilityModelChange:s=>Y(s),slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(ye,{children:[e.jsxs(ae,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(le,{children:"CSP"}),e.jsx(ne,{value:F,onChange:K,input:e.jsx(ce,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:q.map(s=>e.jsx(oe,{value:s.csp_code,disabled:s.order_count===0,children:s.name},s.csp_code))})]}),I&&e.jsx(Le,{filters:i,onFilters:D,onResetFilters:A,results:v.length,sx:{p:2.5,pt:0}}),e.jsxs(Se,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!g.length&&e.jsxs(P,{size:"small",color:"error",startIcon:e.jsx(ve,{icon:"solar:trash-bin-trash-bold"}),onClick:x.onTrue,children:["Delete (",g.length,")"]}),e.jsx(De,{}),e.jsx(ke,{})]}),e.jsx(Ee,{filters:i,onFilters:D,roleOptions:Oe,branchOptions:["hello"],dateError:T,dayError:J})]})}),noRowsOverlay:()=>e.jsx(G,{title:"No Data"}),noResultsOverlay:()=>e.jsx(G,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:R}}})]})]}),e.jsx(Fe,{open:x.value,onClose:x.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",g.length," "]})," items?"]}),action:e.jsx(P,{variant:"contained",color:"error",onClick:()=>{X(),x.onFalse()},children:"Delete"})})]})}function Ve({inputData:l,filters:m,dateError:x,dayError:O}){const{stock:j,publish:r,status:u,commodity:c,name:i,branch:f,startDate:g,endDate:y,startDay:b,endDay:C}=m;return j.length&&(l=l.filter(n=>j.includes(n.inventoryType))),x||g&&y&&(l=l.filter(n=>U(n.created_at,g,y))),O||b&&C&&(l=l.filter(n=>U(n.created_at,b,C))),r.length&&(l=l.filter(n=>r.includes(n.publish))),i&&(l=l.filter(n=>n.name.toLowerCase().indexOf(i.toLowerCase())!==-1)),u!=="all"&&(l=l.filter(n=>n.nccf_order_status===u)),c.length&&(l=l.filter(n=>c.includes(n.commodity))),f.length&&(l=l.filter(n=>f.includes(n.branch))),l}const se={publish:[],stock:[],commodity:[],status:"all",branch:[],name:"",startDate:null,endDate:null,startDay:null,endDay:null},Ye={category:!1},qe=["category","actions"];function Qe({singleCode:l}){const{enqueueSnackbar:m}=ue(),x=he(),O=fe(),j=me();re();const[r,u]=a.useState([]),[c,i]=a.useState(se),[f,g]=a.useState([]),[y,b]=a.useState(!1),[C,n]=a.useState({}),[de,L]=a.useState(!1),[ie,V]=a.useState(Ye),[Y,q]=a.useState([]),[w,F]=a.useState("All"),[Q,E]=a.useState([]),[S,T]=a.useState("All"),[J,B]=a.useState([]),v=z(c.startDate,c.endDate),K=z(c.startDay,c.endDay),I=()=>{const t=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${w}/order`;_.get(t).then(o=>{var p;return u((p=o==null?void 0:o.data)==null?void 0:p.data)}).catch(o=>console.log(o))};a.useEffect(()=>{w==="All"?D():(Z(),I())},[w]);const D=()=>{_.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/ho/order").then(t=>{var o;return u((o=t==null?void 0:t.data)==null?void 0:o.data)}).catch(t=>console.log(t))};a.useEffect(()=>{_.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/state/branch").then(t=>{var N;const o=((N=t==null?void 0:t.data)==null?void 0:N.data)||[],p=[{branch_name:"All"},...o];q(p)}).catch(t=>console.log(t)),D()},[]);const A=Je({inputData:r,filters:c,dateError:v}),Z=async()=>{if(w!=="All"){E([]);try{let o=(await _.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${w}/csp`)).data.data.map(N=>({name:N.name,csp_code:N.csp_code}));const p=[{name:"All",csp_code:"All"},...o];E(p)}catch(t){console.error("Error fetching data:",t)}}};a.useEffect(()=>{S==="All"?I():_.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${S}/orders`).then(t=>{var o;return u((o=t==null?void 0:t.data)==null?void 0:o.data)}).catch(t=>console.log(t))},[S]);const X=a.useCallback(t=>{B(t.target.value),T(t.target.value)},[S]),M=a.useCallback(t=>{F(t.target.value),T("All")},[S]),ee=!xe(se,c)||!!c.startDate&&!!c.endDate||!!c.startDay&&!!c.endDay,R=a.useCallback((t,o)=>{i(p=>({...p,[t]:o}))},[]),s=a.useCallback(()=>{i(se)},[]);a.useCallback(t=>{const o=r.filter(p=>p.id!==t);m("Delete success!"),u(o)},[m,r]);const d=[{value:"all",label:"All"},{value:"accepted",label:"Accepted"},{value:"placed",label:"Placed"},{value:"declined",label:"Declined"}],h=a.useCallback(()=>{const t=r.filter(o=>!f.includes(o.id));m("Delete success!"),u(t)},[m,f,r]);a.useCallback(t=>{},[O]);const k=[{field:"id",headerName:"#",minWidth:100,renderCell:t=>e.jsx(Ae,{children:t.row.id})},{field:"name",headerName:"Name",width:250},{field:"commodity",headerName:"Commodity",minWidth:150,flex:1},{field:"quantity",headerName:"Quantity",minWidth:100,flex:1},{field:"branch",headerName:"Branch",minWidth:100,flex:1},{field:"created_at",headerName:"Date",minWidth:150,flex:1,renderCell:t=>Re(t.row.created_at).format("DD/MM/YYYY")},{field:"nccf_order_status",headerName:"Order Status",minWidth:100,flex:1,renderCell:t=>e.jsx(H,{children:e.jsx(W,{variant:"soft",color:t.row.nccf_order_status==="accepted"&&"success"||t.row.nccf_order_status==="placed"&&"warning"||t.row.nccf_order_status==="declined"&&"error"||"default",children:t.row.nccf_order_status==="accepted"?"Accepted":t.row.nccf_order_status==="declined"?"Declined":"Placed"})})},{field:"vendor1",headerName:"Action",flex:.5,minWidth:250,renderCell:t=>e.jsxs(e.Fragment,{children:[e.jsx(H,{sx:{px:0,marginRight:2},children:e.jsxs(P,{disabled:t.row.nccf_order_status==="accepted"||t.row.nccf_order_status==="declined",variant:"contained",onClick:()=>{n(t.row),L(!0),b(!0)},sx:{backgroundColor:"green",width:90},children:[e.jsx(He,{})," Approve"]})}),e.jsx(H,{sx:{px:0},children:e.jsxs(P,{disabled:t.row.nccf_order_status==="accepted"||t.row.nccf_order_status==="declined",onClick:()=>{n(t.row),L(!1),b(!0)},variant:"contained",sx:{backgroundColor:"red",width:80},children:[e.jsx(ze,{})," Reject"]})})]})}],Pe=a.useCallback((t,o)=>{R("status",o)},[R]),Te=()=>k.filter(t=>!qe.includes(t.field)).map(t=>t.field);return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{maxWidth:j.themeStretch?!1:"xl",children:[e.jsx(be,{heading:"Order List",links:[{name:"Dashboard",href:$.dashboard.root},{name:"Order",href:$.dashboard.orders},{name:"List"}],sx:{mb:{xs:3,md:5}}}),e.jsx(Be,{getAllDocument:D,currentUser:C,open:y,setOpen:b,approve:de,cspCode:J}),e.jsxs(pe,{sx:{height:(A==null?void 0:A.length)>0?"unset":700,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[e.jsx(je,{value:c.status,onChange:Pe,sx:{px:2.5,boxShadow:t=>`inset 0 -2px 0 0 ${Ce(t.palette.grey[500],.08)}`},children:d.map(t=>e.jsx(we,{iconPosition:"end",value:t.value,label:t.label,icon:e.jsx(W,{variant:(t.value==="all"||t.value===c.status)&&"filled"||"soft",color:t.value==="accepted"&&"success"||t.value==="placed"&&"warning"||t.value==="declined"&&"error"||"default",children:["accepted","declined","placed"].includes(t.value)?r.filter(o=>o.nccf_order_status===t.value).length:r.length})},t.value))}),e.jsx(_e,{disableRowSelectionOnClick:!0,rows:A,columns:k,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:5}}},columnVisibilityModel:ie,onColumnVisibilityModelChange:t=>V(t),slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(ye,{children:[e.jsxs(ae,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(le,{children:"Branch"}),e.jsx(ne,{value:w,onChange:M,input:e.jsx(ce,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:Y.map(t=>e.jsx(oe,{value:t.branch_name,children:t.branch_name},t.branch_name))})]}),w!=="All"&&e.jsxs(ae,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(le,{children:"CSP"}),e.jsx(ne,{value:S,onChange:X,input:e.jsx(ce,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:Q.map(t=>e.jsx(oe,{value:t.csp_code,children:t.name},t.csp_code))})]}),ee&&e.jsx(Ie,{filters:c,onFilters:R,onResetFilters:s,results:A.length,sx:{p:2.5,pt:0}}),e.jsxs(Se,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!f.length&&e.jsxs(P,{size:"small",color:"error",startIcon:e.jsx(ve,{icon:"solar:trash-bin-trash-bold"}),onClick:x.onTrue,children:["Delete (",f.length,")"]}),e.jsx(De,{}),e.jsx(ke,{})]}),e.jsx(Me,{filters:c,onFilters:R,roleOptions:Oe,branchOptions:["hello"],dateError:v,dayError:K})]})}),noRowsOverlay:()=>e.jsx(G,{title:"No Data"}),noResultsOverlay:()=>e.jsx(G,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:Te}}})]})]}),e.jsx(Fe,{open:x.value,onClose:x.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",f.length," "]})," items?"]}),action:e.jsx(P,{variant:"contained",color:"error",onClick:()=>{h(),x.onFalse()},children:"Delete"})})]})}function Je({inputData:l,filters:m,dateError:x,dayError:O}){const{stock:j,publish:r,status:u,commodity:c,name:i,branch:f,startDate:g,endDate:y,startDay:b,endDay:C}=m;return j.length&&(l=l.filter(n=>j.includes(n.inventoryType))),x||g&&y&&(l=l.filter(n=>U(n.created_at,g,y))),O||b&&C&&(l=l.filter(n=>U(n.created_at,b,C))),r.length&&(l=l.filter(n=>r.includes(n.publish))),i&&(l=l.filter(n=>n.name.toLowerCase().indexOf(i.toLowerCase())!==-1)),u!=="all"&&(l=l.filter(n=>n.nccf_order_status===u)),c.length&&(l=l.filter(n=>c.includes(n.commodity))),f.length&&(l=l.filter(n=>f.includes(n.branch))),l}function Ze(){const{vendor:l}=re();return e.jsxs(e.Fragment,{children:[e.jsx($e,{children:e.jsx("title",{children:" Dashboard: Order List"})}),(l==null?void 0:l.category)==="branch"?e.jsx(Ue,{}):e.jsx(Qe,{})]})}export{Ze as default};
