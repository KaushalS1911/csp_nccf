import{bF as G,bG as M,r as m,bI as $,$ as q,ax as K,a as Y,da as J,c as Q,ey as X,ee as Z,db as ee,p as f,j as e,C as te,bY as oe,v as F,R as se,i as j,m as k,c8 as A,S as I,K as ae,cj as ne,a1 as le,ck as re,as as ie,cL as ce,dd as de,b_ as y,h as S,cM as ue,cN as me,cO as he,de as ge,df as pe,dg as xe,dh as be,d8 as fe,eg as je,H as ve}from"./index-qJigJXRM.js";import{s as L}from"./sumBy-gog_qMfy.js";import{I as v,a as we,b as Pe,c as Ce}from"./invoice-details-view-fBfpwy3J.js";import"./_baseIteratee--mgbbDVn.js";import"./_baseToString-dGVG0frc.js";import"./_baseSum-gu02AyRp.js";import"./CircularProgress-P2BcVD5b.js";import"./DatePicker-2dws45FR.js";import"./custom-date-range-picker-xlMcYI7a.js";import"./address-list-dialog-Uk9J7qhZ.js";import"./LoadingButton-2E-VIOUU.js";function Re(){const s="http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/commodity",{data:c,isLoading:d,error:x,isValidating:u}=G(s,M);return m.useMemo(()=>({commodities:(c==null?void 0:c.data)||[],commoditiesLoading:d,commoditiesError:x,commoditiesValidating:u,commoditiesEmpty:!d&&!(c!=null&&c.data.length)}),[c==null?void 0:c.data,x,d,u])}const ye=[{id:"invoiceNumber",label:"Customer"},{id:"createDate",label:"Create"},{id:"dueDate",label:"Due"},{id:"price",label:"Amount"},{id:"sent",label:"Sent",align:"center"},{id:"status",label:"Status"},{id:""}],B={name:"",service:[],status:"all",startDate:null,endDate:null};function Se(){const{enqueueSnackbar:s}=$(),{commodities:c}=Re(),d=q(),x=K(),u=Y(),t=J({defaultOrderBy:"createDate"}),p=Q(),[i,b]=m.useState(X),[l,a]=m.useState(B),h=Z(l.startDate,l.endDate),n=De({inputData:i,comparator:ee(t.order,t.orderBy),filters:l,dateError:h}),w=n.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage),E=t.dense?56:76,T=!!l.name||!!l.service.length||l.status!=="all"||!!l.startDate&&!!l.endDate,O=!n.length&&T||!n.length,g=o=>i.filter(r=>r.status===o).length,P=o=>L(i.filter(r=>r.status===o),"totalAmount"),C=o=>g(o)/i.length*100,V=[{value:"all",label:"All",color:"default",count:i.length},{value:"paid",label:"Paid",color:"success",count:g("paid")},{value:"pending",label:"Pending",color:"warning",count:g("pending")},{value:"overdue",label:"Overdue",color:"error",count:g("overdue")},{value:"draft",label:"Draft",color:"default",count:g("draft")}],R=m.useCallback((o,r)=>{t.onResetPage(),a(D=>({...D,[o]:r}))},[t]),z=m.useCallback(()=>{a(B)},[]),H=m.useCallback(o=>{const r=i.filter(D=>D.id!==o);s("Delete success!"),b(r),t.onUpdatePageDeleteRow(w.length)},[w.length,s,t,i]),N=m.useCallback(()=>{const o=i.filter(r=>!t.selected.includes(r.id));s("Delete success!"),b(o),t.onUpdatePageDeleteRows({totalRowsInPage:w.length,totalRowsFiltered:n.length})},[n.length,w.length,s,t,i]),_=m.useCallback(o=>{u.push(f.dashboard.invoice.edit(o))},[u]),U=m.useCallback(o=>{u.push(f.dashboard.invoice.details(o))},[u]),W=m.useCallback((o,r)=>{R("status",r)},[R]);return e.jsxs(e.Fragment,{children:[e.jsxs(te,{maxWidth:x.themeStretch?!1:"lg",children:[e.jsx(oe,{heading:"Payment",links:[{name:"Dashboard",href:f.dashboard.root},{name:"Payment",href:f.dashboard.invoice.root},{name:"List"}],action:e.jsx(F,{component:se,href:f.dashboard.invoice.new,variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),children:"New Invoice"}),sx:{mb:{xs:3,md:5}}}),e.jsx(k,{sx:{mb:{xs:3,md:5}},children:e.jsx(A,{children:e.jsxs(I,{direction:"row",divider:e.jsx(ae,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:[e.jsx(v,{title:"Total",total:i.length,percent:100,price:L(i,"totalAmount"),icon:"solar:bill-list-bold-duotone",color:d.palette.info.main}),e.jsx(v,{title:"Paid",total:g("paid"),percent:C("paid"),price:P("paid"),icon:"solar:file-check-bold-duotone",color:d.palette.success.main}),e.jsx(v,{title:"Pending",total:g("pending"),percent:C("pending"),price:P("pending"),icon:"solar:sort-by-time-bold-duotone",color:d.palette.warning.main}),e.jsx(v,{title:"Overdue",total:g("overdue"),percent:C("overdue"),price:P("overdue"),icon:"solar:bell-bing-bold-duotone",color:d.palette.error.main}),e.jsx(v,{title:"Draft",total:g("draft"),percent:C("draft"),price:P("draft"),icon:"solar:file-corrupted-bold-duotone",color:d.palette.text.secondary})]})})}),e.jsxs(k,{children:[e.jsx(ne,{value:l.status,onChange:W,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${le(d.palette.grey[500],.08)}`},children:V.map(o=>e.jsx(re,{value:o.value,label:o.label,iconPosition:"end",icon:e.jsx(ie,{variant:(o.value==="all"||o.value===l.status)&&"filled"||"soft",color:o.color,children:o.count})},o.value))}),e.jsx(we,{filters:l,onFilters:R,dateError:h,serviceOptions:c.map(o=>o.commodity_name)}),T&&e.jsx(Pe,{filters:l,onFilters:R,onResetFilters:z,results:n.length,sx:{p:2.5,pt:0}}),e.jsxs(ce,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(de,{dense:t.dense,numSelected:t.selected.length,rowCount:n.length,onSelectAllRows:o=>{t.onSelectAllRows(o,n.map(r=>r.id))},action:e.jsxs(I,{direction:"row",children:[e.jsx(y,{title:"Sent",children:e.jsx(S,{color:"primary",children:e.jsx(j,{icon:"iconamoon:send-fill"})})}),e.jsx(y,{title:"Download",children:e.jsx(S,{color:"primary",children:e.jsx(j,{icon:"eva:download-outline"})})}),e.jsx(y,{title:"Print",children:e.jsx(S,{color:"primary",children:e.jsx(j,{icon:"solar:printer-minimalistic-bold"})})}),e.jsx(y,{title:"Delete",children:e.jsx(S,{color:"primary",onClick:p.onTrue,children:e.jsx(j,{icon:"solar:trash-bin-trash-bold"})})})]})}),e.jsx(A,{children:e.jsxs(ue,{size:t.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(me,{order:t.order,orderBy:t.orderBy,headLabel:ye,rowCount:n.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:o=>t.onSelectAllRows(o,n.map(r=>r.id))}),e.jsxs(he,{children:[n.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map(o=>e.jsx(Ce,{row:o,selected:t.selected.includes(o.id),onSelectRow:()=>t.onSelectRow(o.id),onViewRow:()=>U(o.id),onEditRow:()=>_(o.id),onDeleteRow:()=>H(o.id)},o.id)),e.jsx(ge,{height:E,emptyRows:pe(t.page,t.rowsPerPage,n.length)}),e.jsx(xe,{notFound:O})]})]})})]}),e.jsx(be,{count:n.length,page:t.page,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onRowsPerPageChange:t.onChangeRowsPerPage,dense:t.dense,onChangeDense:t.onChangeDense})]})]}),e.jsx(fe,{open:p.value,onClose:p.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",t.selected.length," "]})," items?"]}),action:e.jsx(F,{variant:"contained",color:"error",onClick:()=>{N(),p.onFalse()},children:"Delete"})})]})}function De({inputData:s,comparator:c,filters:d,dateError:x}){const{name:u,status:t,service:p,startDate:i,endDate:b}=d,l=s.map((a,h)=>[a,h]);return l.sort((a,h)=>{const n=c(a[0],h[0]);return n!==0?n:a[1]-h[1]}),s=l.map(a=>a[0]),u&&(s=s.filter(a=>a.invoiceNumber.toLowerCase().indexOf(u.toLowerCase())!==-1||a.invoiceTo.name.toLowerCase().indexOf(u.toLowerCase())!==-1)),t!=="all"&&(s=s.filter(a=>a.status===t)),p.length&&(s=s.filter(a=>a.items.some(h=>p.includes(h.service)))),x||i&&b&&(s=s.filter(a=>je(a.createDate,i,b))),s}function He(){return e.jsxs(e.Fragment,{children:[e.jsx(ve,{children:e.jsx("title",{children:" Dashboard: Payment"})}),e.jsx(Se,{})]})}export{He as default};
