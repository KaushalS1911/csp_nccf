import{N as we,dt as Se,du as ve,ad as i,V as Pe,j as e,m as oe,B as D,T as J,S as T,dv as Re,bG as ae,d as ke,e as v,r as d,f as H,o as _e,by as V,F as G,bz as $,bA as M,bL as Te,d7 as Ae,bZ as k,g as C,D as Q,cW as Oe,bB as Y,t as P,c as B,bx as ne,cK as qe,cL as A,d9 as De,az as Fe,h as le,i as w,bC as ie,da as de,ab as Ee,I as Ie,v as X,dl as U,dm as ee,dw as te,c4 as se,bR as W,K as Ne,u as K,A as _,d6 as re,aE as ce,a as We,dc as Le,dd as ze,aG as Be,C as me,bW as He,R as Ve,dx as Ge,dy as $e,cM as Me,df as Qe,bY as Ye,c6 as Ke,cN as Ze,cO as Je,cP as Xe,dg as Ue,dh as et,di as tt,dj as st,am as O,H as ot}from"./index-4yL3xM3x.js";import{A as at}from"./Alert-NMDWI1wk.js";import{L as nt}from"./LoadingButton-ARrPaHRQ.js";import"./CircularProgress-gwCWj6_h.js";const lt=we("MuiBox",["root"]),it=lt,dt=Se({defaultClassName:it.root,generateClassName:ve.generate}),q=dt;i.string,i.array,i.array,i.string;i.object;function F({title:t,total:a,sx:h,...x}){return Pe(),e.jsx(oe,{sx:{display:"flex",alignItems:"center",p:3,...h},...x,children:e.jsxs(D,{sx:{flexGrow:1},children:[e.jsx(J,{variant:"subtitle2",children:t}),e.jsx(T,{direction:"row",alignItems:"center",sx:{mt:2,mb:1}}),e.jsx(J,{variant:"h3",children:Re(a)})]})})}F.propTypes={chart:i.shape({colors:i.array,series:i.array.isRequired,options:i.object}),percent:i.number,sx:i.object,title:i.string,total:i.number};function ue({currentUser:t,open:a,onClose:h}){const{enqueueSnackbar:x}=ae(),c=ke().shape({name:v().required("Name is required"),email:v().required("Email is required").email("Email must be a valid email address"),phoneNumber:v().required("Phone number is required"),address:v().required("Address is required"),country:v().required("Country is required"),company:v().required("Company is required"),state:v().required("State is required"),city:v().required("City is required"),role:v().required("Role is required")}),s=d.useMemo(()=>({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phoneNumber:(t==null?void 0:t.phoneNumber)||"",address:(t==null?void 0:t.address)||"",country:(t==null?void 0:t.country)||"",state:(t==null?void 0:t.state)||"",city:(t==null?void 0:t.city)||"",zipCode:(t==null?void 0:t.zipCode)||"",status:t==null?void 0:t.status,company:(t==null?void 0:t.company)||"",role:(t==null?void 0:t.role)||""}),[t]),b=H({resolver:_e(c),defaultValues:s}),{reset:u,handleSubmit:o,formState:{isSubmitting:n}}=b,r=o(async m=>{try{await new Promise(g=>setTimeout(g,500)),u(),h(),x("Update success!"),console.info("DATA",m)}catch(g){console.error(g)}});return e.jsx(V,{fullWidth:!0,maxWidth:!1,open:a,onClose:h,PaperProps:{sx:{maxWidth:720}},children:e.jsxs(G,{methods:b,onSubmit:r,children:[e.jsx($,{children:"Quick Update"}),e.jsxs(M,{children:[e.jsx(at,{variant:"outlined",severity:"info",sx:{mb:3},children:"Account is waiting for confirmation"}),e.jsxs(D,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[e.jsx(Te,{name:"status",label:"Status",children:Ae.map(m=>e.jsx(k,{value:m.value,children:m.label},m.value))}),e.jsx(D,{sx:{display:{xs:"none",sm:"block"}}}),e.jsx(C,{name:"name",label:"Full Name"}),e.jsx(C,{name:"email",label:"Email Address"}),e.jsx(C,{name:"phoneNumber",label:"Phone Number"}),e.jsx(Q,{name:"country",type:"country",label:"Country",placeholder:"Choose a country",fullWidth:!0,options:Oe.map(m=>m.label),getOptionLabel:m=>m}),e.jsx(C,{name:"state",label:"State/Region"}),e.jsx(C,{name:"city",label:"City"}),e.jsx(C,{name:"address",label:"Address"}),e.jsx(C,{name:"zipCode",label:"Zip/Code"}),e.jsx(C,{name:"company",label:"Company"}),e.jsx(C,{name:"role",label:"Role"})]})]}),e.jsxs(Y,{children:[e.jsx(P,{variant:"outlined",onClick:h,children:"Cancel"}),e.jsx(nt,{type:"submit",variant:"contained",loading:n,children:"Update"})]})]})})}ue.propTypes={open:i.bool,onClose:i.func,currentUser:i.object};function he({row:t,selected:a,onEditRow:h,onSelectRow:x,onDeleteRow:c}){const{commodity:s,created_at:b,quantity:u,index:o,nccf_order_status:n}=t,r=B(),m=B(),g=ne();return e.jsxs(e.Fragment,{children:[e.jsxs(qe,{hover:!0,selected:a,children:[e.jsx(A,{sx:{whiteSpace:"nowrap"},children:o+1}),e.jsx(A,{sx:{whiteSpace:"nowrap"},children:s}),e.jsx(A,{sx:{whiteSpace:"nowrap"},children:u}),e.jsx(A,{sx:{whiteSpace:"nowrap"},children:De(b).format("DD/MM/YYYY")}),e.jsx(A,{children:e.jsx(Fe,{variant:"soft",color:n==="accepted"&&"success"||n==="placed"&&"warning"||n==="declined"&&"error"||"default",children:n})}),e.jsx(A,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx(le,{color:g.open?"inherit":"default",onClick:g.onOpen,children:e.jsx(w,{icon:"eva:more-vertical-fill"})})})]}),e.jsx(ue,{currentUser:t,open:m.value,onClose:m.onFalse}),e.jsxs(ie,{open:g.open,onClose:g.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(k,{onClick:()=>{r.onTrue(),g.onClose()},sx:{color:"error.main"},children:[e.jsx(w,{icon:"solar:trash-bin-trash-bold"}),"Delete"]}),e.jsxs(k,{onClick:()=>{h(),g.onClose()},children:[e.jsx(w,{icon:"solar:pen-bold"}),"Edit"]})]}),e.jsx(de,{open:r.value,onClose:r.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(P,{variant:"contained",color:"error",onClick:c,children:"Delete"})})]})}he.propTypes={onDeleteRow:i.func,onEditRow:i.func,onSelectRow:i.func,row:i.object,selected:i.bool};function xe({filters:t,onFilters:a,commodityOptions:h,orderStatusOptions:x}){const c=ne(),s=d.useCallback(o=>{a("name",o.target.value)},[a]),b=d.useCallback(o=>{a("commodity",typeof o.target.value=="string"?o.target.value.split(","):o.target.value)},[a]),u=d.useCallback(o=>{a("order_status",typeof o.target.value=="string"?o.target.value.split(","):o.target.value)},[a]);return e.jsxs(e.Fragment,{children:[e.jsx(T,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:2.5},children:e.jsxs(T,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:[e.jsx(Ee,{fullWidth:!0,value:t.name,onChange:s,placeholder:"Search...",InputProps:{startAdornment:e.jsx(Ie,{position:"start",children:e.jsx(w,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsxs(X,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(U,{children:"Commodity"}),e.jsx(ee,{multiple:!0,value:t.commodity,onChange:b,input:e.jsx(te,{label:"Commodity"}),renderValue:o=>o.map(n=>n).join(", "),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:h.map(o=>e.jsxs(k,{value:o,children:[e.jsx(se,{disableRipple:!0,size:"small",checked:t.commodity.includes(o)}),o]},o))})]}),e.jsxs(X,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(U,{children:"Status"}),e.jsx(ee,{multiple:!0,value:t.order_status,onChange:u,input:e.jsx(te,{label:"Status"}),renderValue:o=>o.map(n=>n).join(", "),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:x.map(o=>e.jsxs(k,{value:o,children:[e.jsx(se,{disableRipple:!0,size:"small",checked:t.order_status.includes(o)}),o]},o))})]})]})}),e.jsxs(ie,{open:c.open,onClose:c.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(k,{onClick:()=>{c.onClose()},children:[e.jsx(w,{icon:"solar:printer-minimalistic-bold"}),"Print"]}),e.jsxs(k,{onClick:()=>{c.onClose()},children:[e.jsx(w,{icon:"solar:import-bold"}),"Import"]}),e.jsxs(k,{onClick:()=>{c.onClose()},children:[e.jsx(w,{icon:"solar:export-bold"}),"Export"]})]})]})}xe.propTypes={filters:i.object,onFilters:i.func,roleOptions:i.array};function pe({filters:t,onFilters:a,onResetFilters:h,results:x,...c}){const s=d.useCallback(()=>{a("commodity","")},[a]),b=d.useCallback(()=>{a("status","all")},[a]),u=d.useCallback(n=>{const r=t.commodity.filter(m=>m!==n);a("commodity",r)},[t.commodity,a]),o=d.useCallback(n=>{const r=t.order_status.filter(m=>m!==n);a("order_status",r)},[t.order_status,a]);return e.jsxs(T,{spacing:1.5,...c,children:[e.jsxs(D,{sx:{typography:"body2"},children:[e.jsx("strong",{children:x}),e.jsx(D,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(T,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[t.status!=="all"&&e.jsx(E,{label:"Status:",children:e.jsx(W,{size:"small",label:t.status,onDelete:b})}),!!t.commodity.length&&e.jsx(E,{label:"Commodity:",children:t.commodity.map(n=>e.jsx(W,{label:n,size:"small",onDelete:()=>u(n)},n))}),!!t.order_status.length&&e.jsx(E,{label:"Status:",children:t.order_status.map(n=>e.jsx(W,{label:n,size:"small",onDelete:()=>o(n)},n))}),!!t.name&&e.jsx(E,{label:"Keyword:",children:e.jsx(W,{label:t.name,size:"small",onDelete:s})}),e.jsx(P,{color:"error",onClick:h,startIcon:e.jsx(w,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}pe.propTypes={filters:i.object,onFilters:i.func,onResetFilters:i.func,results:i.number};function E({label:t,children:a,sx:h,...x}){return e.jsxs(T,{component:Ne,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...h},...x,children:[e.jsx(D,{component:"span",sx:{typography:"subtitle2"},children:t}),e.jsx(T,{spacing:1,direction:"row",flexWrap:"wrap",children:a})]})}E.propTypes={children:i.node,label:i.string,sx:i.object};function rt({dialogOpen:t,setDialogOpen:a,editId:h}){const[x,c]=d.useState([]),[s,b]=d.useState([]),{vendor:u}=K();function o(){_.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${u.csp_code}/orders`).then(l=>{var p;b((p=l.data)==null?void 0:p.data)})}d.useEffect(()=>{n(),o()},[]);function n(){_.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/commodity").then(l=>{var p;c((p=l.data)==null?void 0:p.data)})}const r={csp_code:u.csp_code,commodity:"",quantity:""},m=H({defaultValues:r}),{reset:g,handleSubmit:I,formState:{isSubmitting:S}}=m,R=async l=>{a(!1);const p={...l,csp_code:u.csp_code,mode:"test",status:"0"};try{const f=await _.post("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/create_order",p);f.data.status=="201"?re("Order added successfully!"):f.data.status=="400"}catch(f){console.error("Order creation error:",f)}};return e.jsx(e.Fragment,{children:e.jsx(V,{open:t,fullWidth:!0,maxWidth:"md",onClose:()=>a(!1),children:e.jsxs(q,{sx:{py:5,px:3},children:[e.jsx($,{children:"Add Order"}),e.jsxs(G,{methods:m,children:[e.jsxs(M,{maxWidth:"lg ",children:[e.jsx(q,{mb:2,mt:1,children:e.jsx(Q,{name:"commodity",type:"commodity",label:"Commodity",placeholder:"Choose Commodity",fullWidth:!0,options:x.map(l=>l==null?void 0:l.commodity_name),getOptionLabel:l=>l})}),e.jsx(q,{mt:2,children:e.jsx(C,{name:"quantity",label:"Quantity",fullWidth:!0})})]}),e.jsxs(Y,{children:[e.jsx(P,{onClick:()=>a(!1),variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(P,{variant:"contained",onClick:I(R),children:"Add"})]})]})]})})})}function ct({editDialogOpen:t,setEditDialogOpen:a,editId:h}){const[x,c]=d.useState([]),[s,b]=d.useState([]),{vendor:u}=K();function o(){_.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${u.csp_code}/orders`).then(l=>{var p;b((p=l.data)==null?void 0:p.data)})}d.useEffect(()=>{n(),o()},[]);function n(){_.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/commodity").then(l=>{var p;c((p=l.data)==null?void 0:p.data)})}const r={csp_code:u.csp_code,commodity:"",quantity:""},m=H({defaultValues:r}),{reset:g,handleSubmit:I,formState:{isSubmitting:S}}=m,R=async l=>{a(!1);const p={...l,csp_code:u.csp_code,mode:"test",status:"0"};try{const f=await _.post("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/create_order",p);f.data.status=="201"?re("Order added successfully!"):f.data.status=="400"}catch(f){console.error("Order creation error:",f)}};return e.jsx(e.Fragment,{children:e.jsx(V,{open:t,fullWidth:!0,maxWidth:"md",onClose:()=>a(!1),children:e.jsxs(q,{sx:{py:5,px:3},children:[e.jsx($,{children:"Edit Order"}),e.jsxs(G,{methods:m,children:[e.jsxs(M,{maxWidth:"lg ",children:[e.jsx(q,{mb:2,mt:1,children:e.jsx(Q,{name:"commodity",type:"commodity",label:"Commodity",placeholder:"Choose Commodity",fullWidth:!0,options:x.map(l=>l==null?void 0:l.commodity_name),getOptionLabel:l=>l})}),e.jsx(q,{mt:2,children:e.jsx(C,{name:"quantity",label:"Quantity",fullWidth:!0})})]}),e.jsxs(Y,{children:[e.jsx(P,{onClick:()=>a(!1),variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(P,{variant:"contained",onClick:I(R),children:"Save"})]})]})]})})})}const mt=[{id:"srNo",label:"Sr No",width:100},{id:"commodity",label:"Commodity",width:200},{id:"quantity",label:"Quantity",width:200},{id:"created_at",label:"Date",width:180},{id:"status",label:"Status",width:100},{id:"",width:88}],z={name:"",commodity:[],order_status:[],status:"all"};function ut({tableData:t}){const{enqueueSnackbar:a}=ae(),h=ce(),x=We(),c=B(),s=Le(),[b,u]=d.useState(!1),[o,n]=d.useState(!1),[r,m]=d.useState(z),[g,I]=d.useState(""),[S,R]=d.useState(t);d.useEffect(()=>{R(t)},[t]);const l=ht({inputData:S,comparator:ze(s.order,s.orderBy),filters:r}),p=l.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage),f=s.dense?56:76,Z=!Be(z,r),je=!l.length&&Z||!l.length,N=d.useCallback((j,y)=>{s.onResetPage(),m(L=>({...L,[j]:y}))},[s]),be=d.useCallback(()=>{m(z)},[]),ge=d.useCallback(j=>{const y=S.filter(L=>L.id!==j);a("Delete success!"),R(y),s.onUpdatePageDeleteRow(p.length)},[p.length,a,s,S]),ye=d.useCallback(()=>{const j=S.filter(y=>!s.selected.includes(y.id));a("Delete success!"),R(j),s.onUpdatePageDeleteRows({totalRowsInPage:p.length,totalRowsFiltered:l.length})},[l.length,p.length,a,s,S]),fe=d.useCallback(j=>{n(!0)},[x]);d.useCallback((j,y)=>{N("status",y)},[N]);const Ce=d.useCallback(j=>{R(y=>[...y,j])},[a]);return e.jsxs(e.Fragment,{children:[e.jsxs(me,{maxWidth:h.themeStretch?!1:"xxl",children:[e.jsx(He,{heading:"Orders",links:[{name:""}],action:e.jsx(P,{component:Ve,variant:"contained",startIcon:e.jsx(w,{icon:"mingcute:add-line"}),onClick:()=>{u(!0),Ce({id:String(Date.now()),srNo:String(S.length+1),commodity:"New Commodity",created_at:new Date().toISOString(),status:"placed"})},children:"Add Order"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(oe,{children:[e.jsx(xe,{filters:r,onFilters:N,commodityOptions:Ge,orderStatusOptions:$e}),Z&&e.jsx(pe,{filters:r,onFilters:N,onResetFilters:be,results:l.length,sx:{p:2.5,pt:0}}),e.jsxs(Me,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(Qe,{dense:!0,numSelected:s.selected.length,rowCount:l.length,onSelectAllRows:j=>s.onSelectAllRows(j,l.map(y=>y.id)),action:e.jsx(Ye,{title:"Delete",children:e.jsx(le,{color:"primary",onClick:c.onTrue,children:e.jsx(w,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(Ke,{children:e.jsxs(Ze,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Je,{order:s.order,orderBy:s.orderBy,headLabel:mt,rowCount:l.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:j=>s.onSelectAllRows(j,l.map(y=>y.id))}),e.jsxs(Xe,{children:[l.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map((j,y)=>e.jsx(he,{row:{...j,index:y},selected:s.selected.includes(j.id),onSelectRow:()=>s.onSelectRow(j.id),onDeleteRow:()=>ge(j.id),onEditRow:()=>fe(j.id)},j.id)),e.jsx(Ue,{height:f,emptyRows:et(s.page,s.rowsPerPage,S.length)}),e.jsx(tt,{isNotFound:je})]})]})}),e.jsx(st,{count:l.length,page:s.page,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onRowsPerPageChange:s.onChangeRowsPerPage,dense:s.dense,onChangeDense:s.onChangeDense})]})]})]}),e.jsx(de,{open:c.value,onClose:c.onFalse,title:"Delete",content:"Are you sure you want to delete?",action:e.jsx(P,{variant:"contained",color:"error",onClick:()=>{ye(),c.onFalse()},children:"Delete"})}),e.jsx(rt,{dialogOpen:b,setDialogOpen:u,editId:g}),e.jsx(ct,{editDialogOpen:o,setEditDialogOpen:n,editId:g})]})}function ht({inputData:t,comparator:a,filters:h}){const{name:x,status:c,commodity:s,order_status:b}=h,u=t.map((o,n)=>[o,n]);return u.sort((o,n)=>{const r=a(o[0],n[0]);return r!==0?r:o[1]-n[1]}),t=u.map(o=>o[0]),x&&(t=t.filter(o=>o.commodity.toLowerCase().includes(x.toLowerCase()))),c!=="all"&&(t=t.filter(o=>o.status===c)),s.length&&(t=t.filter(o=>s.includes(o.commodity))),b.length&&(t=t.filter(o=>b.includes(o.nccf_order_status))),t}function xt({vendorCode:t}){const{vendor:a}=K(),h=ce(),[x,c]=d.useState([]),[s,b]=d.useState({});d.useEffect(()=>{a.csp_code&&(o(),u())},[a]);function u(){_.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${a.csp_code}/orders_stats`).then(n=>{var r;b((r=n.data)==null?void 0:r.data[0])})}function o(){_.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${a.csp_code}/orders`).then(n=>{var r;c((r=n.data)==null?void 0:r.data)})}return e.jsx(me,{maxWidth:h.themeStretch?!1:"xl",children:e.jsxs(O,{container:!0,spacing:3,children:[e.jsx(O,{xs:12,md:3,children:e.jsx(F,{title:"Total Orders",total:(s==null?void 0:s.total_orders)||"0"})}),e.jsx(O,{xs:12,md:3,children:e.jsx(F,{title:"Orders Pending",total:(s==null?void 0:s.placed_orders)||"0"})}),e.jsx(O,{xs:12,md:3,children:e.jsx(F,{title:"Orders Accepted",total:(s==null?void 0:s.accepted_orders)||"0"})}),e.jsx(O,{xs:12,md:3,children:e.jsx(F,{title:"Orders Declined",total:(s==null?void 0:s.declined_orders)||"0"})}),e.jsx(O,{xs:12,lg:12,children:e.jsx(ut,{tableData:x})})]})})}function yt(){return e.jsxs(e.Fragment,{children:[e.jsx(ot,{children:e.jsx("title",{children:" NCCF CSP Portal "})}),e.jsx(xt,{})]})}export{yt as default};
