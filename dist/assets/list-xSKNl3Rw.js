import{cn as oe,c as re,a as ce,aF as ie,u as le,r as a,dY as L,K as v,aJ as de,j as t,C as ue,cu as he,p as N,dZ as Oe,q as fe,d_ as xe,a4 as me,d$ as ge,aA as E,dH as be,dI as je,E as X,cG as ee,cH as te,cI as se,cd as Ce,e0 as Fe,S as pe,D,i as we,dM as _e,dO as ye,e1 as Re,e2 as Se,aV as M,d0 as ve,e3 as I,cP as De,e4 as ke,bN as A,e5 as Pe,e6 as Te,e7 as Ae,e8 as Le,e9 as Ne,H as Ee}from"./index-OxY4Mg7q.js";const K={publish:[],stock:[],commodity:[],status:"all",branch:[],name:"",startDate:null,endDate:null,startDay:null,endDay:null},Me={category:!1},Ie=["category","actions"];function Be({singleCode:l}){const{enqueueSnackbar:h}=oe(),f=re(),y=ce(),b=ie(),{vendor:i}=le(),[d,o]=a.useState([]),[r,u]=a.useState(K),[x,p]=a.useState([]),[m,j]=a.useState(!1),[n,ae]=a.useState({}),[F,ne]=a.useState(!1),[B,H]=a.useState(Me),[W,w]=a.useState([]),[S,z]=a.useState([]),[G,R]=a.useState([]),P=L(r.startDate,r.endDate),$=L(r.startDay,r.endDay),k=e=>{const s=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${e}/orders`;v.get(s).then(c=>{var _;return o((_=c==null?void 0:c.data)==null?void 0:_.data)}).catch(c=>console.log(c))};a.useEffect(()=>{i&&(v.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080//nccf/branch/${i==null?void 0:i.branch}/csp/list`).then(e=>{var _;const s=((_=e==null?void 0:e.data)==null?void 0:_.data)||[],c=[{name:"All",csp_code:"All"},...s];w(c)}).catch(e=>console.log(e)),v.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/noida/order").then(e=>{var s;return o((s=e==null?void 0:e.data)==null?void 0:s.data)}).catch(e=>console.log(e)))},[]),a.useEffect(()=>{if(S==="All"){const e=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/branch/${i==null?void 0:i.branch}/order`;v.get(e).then(s=>{var c;return o((c=s==null?void 0:s.data)==null?void 0:c.data)}).catch(s=>console.log(s))}else k(S)},[S]);const g=He({inputData:d,filters:r,dateError:P}),T=a.useCallback(e=>{R(e.target.value),z(e.target.value)},[S]),U=!de(K,r)||!!r.startDate&&!!r.endDate||!!r.startDay&&!!r.endDay,C=a.useCallback((e,s)=>{u(c=>({...c,[e]:s}))},[]),Y=a.useCallback(()=>{u(K)},[]);a.useCallback(e=>{const s=d.filter(c=>c.id!==e);h("Delete success!"),o(s)},[h,d]);const V=[{value:"all",label:"All"},{value:"1",label:"Accepted"},{value:"placed",label:"Placed"},{value:"0",label:"Declined"}],q=a.useCallback(()=>{const e=d.filter(s=>!x.includes(s.id));h("Delete success!"),o(e)},[h,x,d]);a.useCallback(e=>{},[y]);const O=[{field:"id",headerName:"#",minWidth:200,renderCell:e=>t.jsx(De,{children:e.row.id})},{field:"commodity",headerName:"Commodity",minWidth:150,flex:1},{field:"quantity",headerName:"Quantity",minWidth:100,flex:1},{field:"created_at",headerName:"Date",minWidth:150,flex:1,renderCell:e=>ke(e.row.created_at).format("DD/MM/YYYY")},{field:"nccf_order_status",headerName:"Order Status",minWidth:100,flex:1,renderCell:e=>t.jsx(A,{children:t.jsx(E,{variant:"soft",color:e.row.nccf_order_status==="1"&&"success"||e.row.nccf_order_status==="placed"&&"warning"||e.row.nccf_order_status==="0"&&"error"||"default",children:e.row.nccf_order_status==="1"?"Approved":e.row.nccf_order_status==="0"?"Rejected":"Placed"})})}],Q=a.useCallback((e,s)=>{C("status",s)},[C]),J=()=>O.filter(e=>!Ie.includes(e.field)).map(e=>e.field);return t.jsxs(t.Fragment,{children:[t.jsxs(ue,{maxWidth:b.themeStretch?!1:"xl",children:[t.jsx(he,{heading:"Order List",links:[{name:"Dashboard",href:N.dashboard.root},{name:"Order",href:N.dashboard.orders},{name:"List"}],sx:{mb:{xs:3,md:5}}}),t.jsx(Oe,{getAllDocument:k,currentUser:n,open:m,setOpen:j,approve:F,cspCode:G}),t.jsxs(fe,{sx:{height:(g==null?void 0:g.length)>0?"unset":700,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[t.jsx(xe,{value:r.status,onChange:Q,sx:{px:2.5,boxShadow:e=>`inset 0 -2px 0 0 ${me(e.palette.grey[500],.08)}`},children:V.map(e=>t.jsx(ge,{iconPosition:"end",value:e.value,label:e.label,icon:t.jsx(E,{variant:(e.value==="all"||e.value===r.status)&&"filled"||"soft",color:e.value==="1"&&"success"||e.value==="placed"&&"warning"||e.value==="0"&&"error"||"default",children:["1","0","placed"].includes(e.value)?d.filter(s=>s.nccf_order_status===e.value).length:d.length})},e.value))}),t.jsx(be,{disableRowSelectionOnClick:!0,rows:g,columns:O,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:5}}},columnVisibilityModel:B,onColumnVisibilityModelChange:e=>H(e),slots:{toolbar:()=>t.jsx(t.Fragment,{children:t.jsxs(je,{children:[t.jsxs(X,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[t.jsx(ee,{children:"CSP"}),t.jsx(te,{value:S,onChange:T,input:t.jsx(se,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:W.map(e=>t.jsx(Ce,{value:e.csp_code,disabled:e.order_count===0,children:e.name},e.csp_code))})]}),U&&t.jsx(Fe,{filters:r,onFilters:C,onResetFilters:Y,results:g.length,sx:{p:2.5,pt:0}}),t.jsxs(pe,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!x.length&&t.jsxs(D,{size:"small",color:"error",startIcon:t.jsx(we,{icon:"solar:trash-bin-trash-bold"}),onClick:f.onTrue,children:["Delete (",x.length,")"]}),t.jsx(_e,{}),t.jsx(ye,{})]}),t.jsx(Re,{filters:r,onFilters:C,roleOptions:Se,branchOptions:["hello"],dateError:P,dayError:$})]})}),noRowsOverlay:()=>t.jsx(M,{title:"No Data"}),noResultsOverlay:()=>t.jsx(M,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:J}}})]})]}),t.jsx(ve,{open:f.value,onClose:f.onFalse,title:"Delete",content:t.jsxs(t.Fragment,{children:["Are you sure want to delete ",t.jsxs("strong",{children:[" ",x.length," "]})," items?"]}),action:t.jsx(D,{variant:"contained",color:"error",onClick:()=>{q(),f.onFalse()},children:"Delete"})})]})}function He({inputData:l,filters:h,dateError:f,dayError:y}){const{stock:b,publish:i,status:d,commodity:o,name:r,branch:u,startDate:x,endDate:p,startDay:m,endDay:j}=h;return b.length&&(l=l.filter(n=>b.includes(n.inventoryType))),f||x&&p&&(l=l.filter(n=>I(n.created_at,x,p))),y||m&&j&&(l=l.filter(n=>I(n.created_at,m,j))),i.length&&(l=l.filter(n=>i.includes(n.publish))),r&&(l=l.filter(n=>n.name.toLowerCase().indexOf(r.toLowerCase())!==-1)),d!=="all"&&(l=l.filter(n=>n.nccf_order_status===d)),o.length&&(l=l.filter(n=>o.includes(n.commodity))),u.length&&(l=l.filter(n=>u.includes(n.branch))),l}const Z={publish:[],stock:[],commodity:[],status:"all",branch:[],name:"",startDate:null,endDate:null,startDay:null,endDay:null},We={category:!1},ze=["category","actions"];function Ge({singleCode:l}){const{enqueueSnackbar:h}=oe(),f=re(),y=ce(),b=ie();le();const[i,d]=a.useState([]),[o,r]=a.useState(Z),[u,x]=a.useState([]),[p,m]=a.useState(!1),[j,n]=a.useState({}),[ae,F]=a.useState(!1),[ne,B]=a.useState(We),[H,W]=a.useState([]),[w,S]=a.useState("All"),[z,G]=a.useState([]),R=L(o.startDate,o.endDate),P=L(o.startDay,o.endDay),$=()=>{const e=`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/${w}/orders`;v.get(e).then(s=>{var c;return d((c=s==null?void 0:s.data)==null?void 0:c.data)}).catch(s=>console.log(s))};a.useEffect(()=>{w==="All"?k():$()},[w]);const k=()=>{v.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/ho/order").then(e=>{var s;return d((s=e==null?void 0:e.data)==null?void 0:s.data)}).catch(e=>console.log(e))};a.useEffect(()=>{v.get("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/ho/csp/list").then(e=>{var _;const s=((_=e==null?void 0:e.data)==null?void 0:_.data)||[],c=[{name:"All",csp_code:"All"},...s];W(c)}).catch(e=>console.log(e))},[]);const g=$e({inputData:i,filters:o,dateError:R}),T=a.useCallback(e=>{G(e.target.value),S(e.target.value)},[w]),U=!de(Z,o)||!!o.startDate&&!!o.endDate||!!o.startDay&&!!o.endDay,C=a.useCallback((e,s)=>{r(c=>({...c,[e]:s}))},[]),Y=a.useCallback(()=>{r(Z)},[]);a.useCallback(e=>{const s=i.filter(c=>c.id!==e);h("Delete success!"),d(s)},[h,i]);const V=[{value:"all",label:"All"},{value:"1",label:"Accepted"},{value:"",label:"Placed"},{value:"0",label:"Declined"}],q=a.useCallback(()=>{const e=i.filter(s=>!u.includes(s.id));h("Delete success!"),d(e)},[h,u,i]);a.useCallback(e=>{},[y]);const O=[{field:"id",headerName:"#",minWidth:100,renderCell:e=>t.jsx(De,{children:e.row.id})},{field:"commodity",headerName:"Commodity",minWidth:150,flex:1},{field:"quantity",headerName:"Quantity",minWidth:100,flex:1},{field:"branch",headerName:"Branch",minWidth:100,flex:1},{field:"created_at",headerName:"Date",minWidth:150,flex:1,renderCell:e=>ke(e.row.created_at).format("DD/MM/YYYY")},{field:"nccf_order_status",headerName:"Order Status",minWidth:100,flex:1,renderCell:e=>t.jsx(A,{children:t.jsx(E,{variant:"soft",color:e.row.nccf_order_status==="1"&&"success"||e.row.nccf_order_status===""&&"warning"||e.row.nccf_order_status==="0"&&"error"||"default",children:e.row.nccf_order_status==="1"?"Accepted":e.row.nccf_order_status==="0"?"Declined":"Placed"})})},{field:"vendor1",headerName:"Action",flex:.5,minWidth:250,renderCell:e=>t.jsxs(t.Fragment,{children:[t.jsx(A,{sx:{px:0,marginRight:2},children:t.jsxs(D,{disabled:e.row.nccf_order_status==="1"||e.row.nccf_order_status==="0",variant:"contained",onClick:()=>{n(e.row),F(!0),m(!0)},sx:{backgroundColor:"green",width:90},children:[t.jsx(Le,{})," Approve"]})}),t.jsx(A,{sx:{px:0},children:t.jsxs(D,{disabled:e.row.nccf_order_status==="1"||e.row.nccf_order_status==="0",onClick:()=>{n(e.row),F(!1),m(!0)},variant:"contained",sx:{backgroundColor:"red",width:80},children:[t.jsx(Ne,{})," Reject"]})})]})}],Q=a.useCallback((e,s)=>{C("status",s)},[C]),J=()=>O.filter(e=>!ze.includes(e.field)).map(e=>e.field);return t.jsxs(t.Fragment,{children:[t.jsxs(ue,{maxWidth:b.themeStretch?!1:"xl",children:[t.jsx(he,{heading:"Order List",links:[{name:"Dashboard",href:N.dashboard.root},{name:"Order",href:N.dashboard.orders},{name:"List"}],sx:{mb:{xs:3,md:5}}}),t.jsx(Pe,{getAllDocument:k,currentUser:j,open:p,setOpen:m,approve:ae,cspCode:z}),t.jsxs(fe,{sx:{height:(g==null?void 0:g.length)>0?"unset":700,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[t.jsx(xe,{value:o.status,onChange:Q,sx:{px:2.5,boxShadow:e=>`inset 0 -2px 0 0 ${me(e.palette.grey[500],.08)}`},children:V.map(e=>t.jsx(ge,{iconPosition:"end",value:e.value,label:e.label,icon:t.jsx(E,{variant:(e.value==="all"||e.value===o.status)&&"filled"||"soft",color:e.value==="1"&&"success"||e.value===""&&"warning"||e.value==="0"&&"error"||"default",children:["1","0",""].includes(e.value)?i.filter(s=>s.nccf_order_status===e.value).length:i.length})},e.value))}),t.jsx(be,{disableRowSelectionOnClick:!0,rows:g,columns:O,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:5}}},columnVisibilityModel:ne,onColumnVisibilityModelChange:e=>B(e),slots:{toolbar:()=>t.jsx(t.Fragment,{children:t.jsxs(je,{children:[t.jsxs(X,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[t.jsx(ee,{children:"Branch"}),t.jsx(te,{value:w,onChange:T,input:t.jsx(se,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}}})]}),t.jsxs(X,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[t.jsx(ee,{children:"CSP"}),t.jsx(te,{value:w,onChange:T,input:t.jsx(se,{label:"Type"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:H.map(e=>t.jsx(Ce,{value:e.csp_code,disabled:e.order_count===0,children:e.name},e.csp_code))})]}),U&&t.jsx(Te,{filters:o,onFilters:C,onResetFilters:Y,results:g.length,sx:{p:2.5,pt:0}}),t.jsxs(pe,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!u.length&&t.jsxs(D,{size:"small",color:"error",startIcon:t.jsx(we,{icon:"solar:trash-bin-trash-bold"}),onClick:f.onTrue,children:["Delete (",u.length,")"]}),t.jsx(_e,{}),t.jsx(ye,{})]}),t.jsx(Ae,{filters:o,onFilters:C,roleOptions:Se,branchOptions:["hello"],dateError:R,dayError:P})]})}),noRowsOverlay:()=>t.jsx(M,{title:"No Data"}),noResultsOverlay:()=>t.jsx(M,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:J}}})]})]}),t.jsx(ve,{open:f.value,onClose:f.onFalse,title:"Delete",content:t.jsxs(t.Fragment,{children:["Are you sure want to delete ",t.jsxs("strong",{children:[" ",u.length," "]})," items?"]}),action:t.jsx(D,{variant:"contained",color:"error",onClick:()=>{q(),f.onFalse()},children:"Delete"})})]})}function $e({inputData:l,filters:h,dateError:f,dayError:y}){const{stock:b,publish:i,status:d,commodity:o,name:r,branch:u,startDate:x,endDate:p,startDay:m,endDay:j}=h;return b.length&&(l=l.filter(n=>b.includes(n.inventoryType))),f||x&&p&&(l=l.filter(n=>I(n.created_at,x,p))),y||m&&j&&(l=l.filter(n=>I(n.created_at,m,j))),i.length&&(l=l.filter(n=>i.includes(n.publish))),r&&(l=l.filter(n=>n.name.toLowerCase().indexOf(r.toLowerCase())!==-1)),d!=="all"&&(l=l.filter(n=>n.nccf_order_status===d)),o.length&&(l=l.filter(n=>o.includes(n.commodity))),u.length&&(l=l.filter(n=>u.includes(n.branch))),l}function Ye(){const{vendor:l}=le();return t.jsxs(t.Fragment,{children:[t.jsx(Ee,{children:t.jsx("title",{children:" Dashboard: Order List"})}),(l==null?void 0:l.category)==="branch"?t.jsx(Be,{}):t.jsx(Ge,{})]})}export{Ye as default};
